//////////////////////////////////////////////////////////////////////
//
//                             Pixie
//
// Copyright © 1999 - 2003, Okan Arikan
//
// Contact: okan@cs.utexas.edu
//
//	This library is free software; you can redistribute it and/or
//	modify it under the terms of the GNU Lesser General Public
//	License as published by the Free Software Foundation; either
//	version 2.1 of the License, or (at your option) any later version.
//
//	This library is distributed in the hope that it will be useful,
//	but WITHOUT ANY WARRANTY; without even the implied warranty of
//	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
//	Lesser General Public License for more details.
//
//	You should have received a copy of the GNU Lesser General Public
//	License along with this library; if not, write to the Free Software
//	Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
//
///////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////
//
//  File				:	noise.cpp
//  Classes				:	-
//  Description			:	The misc noise functions
//
////////////////////////////////////////////////////////////////////////
#include <math.h>

#include "common/algebra.h"
#include "common/os.h"
#include "noise.h"


#define FADE(t) ( t * t * t * ( t * ( t * 6 - 15 ) + 10 ) )
#define FASTFLOOR(x) ( ((x)>0) ? ((int)x) : ((int)x-1 ) )
#define LERP(t, a, b) ((a) + (t)*((b)-(a)))

/*
// Different permutation tables for x,y and z
static	const unsigned char		permX[512]	= {79,93,101,69,34,92,73,3,170,228,215,128,141,15,70,50,146,103,175,218,75,53,187,237,105,217,112,179,99,31,119,116,144,36,98,102,107,115,138,136,5,235,243,196,224,11,253,83,44,1,90,207,142,35,165,208,254,125,255,134,113,188,122,164,197,45,8,27,118,201,72,223,127,91,183,76,10,240,49,17,77,229,139,111,158,216,61,249,43,250,82,176,121,185,174,25,227,87,155,143,47,199,137,236,21,168,156,166,153,4,145,124,212,56,226,109,130,46,65,58,80,54,120,71,20,117,110,24,205,63,132,114,9,221,181,89,140,100,52,225,203,231,18,248,33,167,131,0,16,81,193,149,108,150,6,62,189,42,233,220,195,177,200,163,88,135,214,190,41,171,148,59,178,48,210,67,244,106,14,184,29,66,234,191,194,213,242,172,7,219,104,39,169,28,96,232,51,12,57,161,246,74,22,159,13,40,95,198,38,64,78,151,126,239,68,55,245,154,162,206,37,238,252,32,23,157,84,241,209,186,97,182,19,30,86,26,192,180,173,123,202,204,211,230,133,152,60,85,251,129,94,222,160,147,2,247,79,93,101,69,34,92,73,3,170,228,215,128,141,15,70,50,146,103,175,218,75,53,187,237,105,217,112,179,99,31,119,116,144,36,98,102,107,115,138,136,5,235,243,196,224,11,253,83,44,1,90,207,142,35,165,208,254,125,255,134,113,188,122,164,197,45,8,27,118,201,72,223,127,91,183,76,10,240,49,17,77,229,139,111,158,216,61,249,43,250,82,176,121,185,174,25,227,87,155,143,47,199,137,236,21,168,156,166,153,4,145,124,212,56,226,109,130,46,65,58,80,54,120,71,20,117,110,24,205,63,132,114,9,221,181,89,140,100,52,225,203,231,18,248,33,167,131,0,16,81,193,149,108,150,6,62,189,42,233,220,195,177,200,163,88,135,214,190,41,171,148,59,178,48,210,67,244,106,14,184,29,66,234,191,194,213,242,172,7,219,104,39,169,28,96,232,51,12,57,161,246,74,22,159,13,40,95,198,38,64,78,151,126,239,68,55,245,154,162,206,37,238,252,32,23,157,84,241,209,186,97,182,19,30,86,26,192,180,173,123,202,204,211,230,133,152,60,85,251,129,94,222,160,147,2,247};
static	const unsigned char		permY[512]	= {48,65,205,77,126,222,16,125,64,198,51,223,75,26,63,112,208,118,123,215,179,136,152,158,181,147,188,97,221,27,231,219,6,105,247,107,76,203,20,157,170,165,45,140,53,23,0,38,224,73,167,217,69,60,32,211,82,156,196,83,70,34,14,92,24,59,86,155,187,111,120,163,237,248,100,169,178,103,234,195,85,1,229,94,80,193,117,216,132,42,62,176,96,10,39,164,154,246,2,88,37,139,108,84,22,148,52,210,161,249,29,98,104,255,15,110,54,7,41,200,44,168,9,194,250,74,235,220,227,225,19,173,142,232,93,102,162,192,121,137,135,99,43,213,186,245,228,197,79,183,185,3,114,101,124,177,151,218,226,253,46,95,240,113,50,244,40,5,138,160,35,81,134,141,159,175,238,189,127,230,146,47,206,25,115,207,212,199,172,17,68,87,131,184,106,251,12,153,21,144,122,72,214,166,209,143,58,28,66,236,191,55,133,90,190,18,56,109,241,119,239,78,33,180,128,91,31,4,174,71,30,49,67,130,242,145,204,61,129,243,252,254,89,182,116,36,171,57,8,150,149,202,13,201,11,233,48,65,205,77,126,222,16,125,64,198,51,223,75,26,63,112,208,118,123,215,179,136,152,158,181,147,188,97,221,27,231,219,6,105,247,107,76,203,20,157,170,165,45,140,53,23,0,38,224,73,167,217,69,60,32,211,82,156,196,83,70,34,14,92,24,59,86,155,187,111,120,163,237,248,100,169,178,103,234,195,85,1,229,94,80,193,117,216,132,42,62,176,96,10,39,164,154,246,2,88,37,139,108,84,22,148,52,210,161,249,29,98,104,255,15,110,54,7,41,200,44,168,9,194,250,74,235,220,227,225,19,173,142,232,93,102,162,192,121,137,135,99,43,213,186,245,228,197,79,183,185,3,114,101,124,177,151,218,226,253,46,95,240,113,50,244,40,5,138,160,35,81,134,141,159,175,238,189,127,230,146,47,206,25,115,207,212,199,172,17,68,87,131,184,106,251,12,153,21,144,122,72,214,166,209,143,58,28,66,236,191,55,133,90,190,18,56,109,241,119,239,78,33,180,128,91,31,4,174,71,30,49,67,130,242,145,204,61,129,243,252,254,89,182,116,36,171,57,8,150,149,202,13,201,11,233};
static	const unsigned char		permZ[512]	= {190,5,42,32,253,64,220,215,20,222,39,133,97,146,22,198,161,1,151,184,228,204,138,154,218,46,236,141,126,185,60,82,143,131,93,127,58,65,88,251,28,211,35,147,175,7,230,2,181,148,160,76,209,59,105,183,101,16,47,26,182,227,63,242,80,99,177,238,199,86,129,0,244,84,174,14,74,100,44,106,229,145,29,36,94,180,168,221,237,233,216,225,252,167,197,3,169,72,223,178,156,121,224,201,150,239,155,9,166,8,249,33,51,117,163,245,132,77,18,217,96,54,243,142,255,114,207,55,66,205,125,48,213,17,11,23,83,157,19,210,119,92,90,109,196,61,186,120,123,192,130,79,135,12,103,50,191,91,107,85,38,102,171,208,170,113,25,78,27,37,159,179,57,115,30,214,250,81,110,149,111,219,152,172,187,193,53,246,13,144,24,73,231,188,139,41,43,212,45,70,194,241,254,136,89,235,234,87,128,10,202,75,232,134,34,162,52,124,247,195,248,31,62,206,122,153,95,68,104,40,203,49,67,56,71,98,226,164,158,240,108,4,176,189,112,21,173,118,116,15,6,165,200,137,69,140,190,5,42,32,253,64,220,215,20,222,39,133,97,146,22,198,161,1,151,184,228,204,138,154,218,46,236,141,126,185,60,82,143,131,93,127,58,65,88,251,28,211,35,147,175,7,230,2,181,148,160,76,209,59,105,183,101,16,47,26,182,227,63,242,80,99,177,238,199,86,129,0,244,84,174,14,74,100,44,106,229,145,29,36,94,180,168,221,237,233,216,225,252,167,197,3,169,72,223,178,156,121,224,201,150,239,155,9,166,8,249,33,51,117,163,245,132,77,18,217,96,54,243,142,255,114,207,55,66,205,125,48,213,17,11,23,83,157,19,210,119,92,90,109,196,61,186,120,123,192,130,79,135,12,103,50,191,91,107,85,38,102,171,208,170,113,25,78,27,37,159,179,57,115,30,214,250,81,110,149,111,219,152,172,187,193,53,246,13,144,24,73,231,188,139,41,43,212,45,70,194,241,254,136,89,235,234,87,128,10,202,75,232,134,34,162,52,124,247,195,248,31,62,206,122,153,95,68,104,40,203,49,67,56,71,98,226,164,158,240,108,4,176,189,112,21,173,118,116,15,6,165,200,137,69,140};

// Permutation tables for the cell noise
static	const unsigned short	permN[4096]	= {110,800,524,4089,1657,3910,3143,2785,3918,671,441,549,1158,3434,3152,2884,2696,329,797,3478,2569,3633,2735,2720,2707,177,1555,112,1185,1032,2281,2345,1821,1645,3630,3477,215,2172,1630,74,3527,1059,1204,1372,1173,665,1333,3353,1791,1188,1736,2895,368,4013,2099,318,1166,2144,959,482,755,2342,3007,3031,1111,333,676,1234,2909,1047,4042,3889,1786,210,3732,2659,3948,2839,1887,3401,2837,828,1183,558,1704,254,790,3108,2469,4048,1833,2773,1146,2928,3089,3648,1316,2830,1147,2439,727,3396,2824,3344,2783,2668,337,2349,3660,255,2953,3440,3403,45,2059,3662,1131,1237,3224,1408,93,2505,2271,2517,1530,719,3445,2624,3001,2961,2710,2758,2981,3568,1163,3450,3528,3906,889,1614,426,3180,3891,2113,3376,3382,810,159,4026,2731,1750,3070,1621,2423,3919,2542,2020,2556,2898,2746,52,1713,2459,2682,535,1268,2557,1218,2231,1820,3501,866,299,246,1245,3391,324,1826,3592,2346,3833,1500,2135,2002,2374,2499,3275,2991,3832,864,170,1468,3292,3033,2070,331,2449,3942,905,82,131,2205,2796,1161,1913,2121,1003,2244,1878,3172,3102,1287,2935,534,4071,2857,1845,587,3138,3170,637,2709,2917,1961,156,2844,2174,3097,2681,173,1176,3762,2134,2091,3231,1137,2540,216,1762,1094,2543,3327,508,2872,2605,3424,1650,906,1911,3158,848,2582,653,1208,3124,1258,3251,410,638,2751,3764,2215,3238,249,3498,3081,1747,1069,2259,268,641,2495,2819,3465,2292,233,1207,1502,2417,3619,3096,2198,218,1388,1404,523,2975,3975,3475,1570,467,2069,3020,2509,1427,2245,2379,1040,2030,1604,1414,3863,2129,427,3993,3623,36,2479,1927,172,2408,3510,3221,428,1674,2742,974,2300,286,2485,1967,2477,2931,120,227,1102,389,543,3758,1356,1986,3294,1033,2845,2606,2897,3350,4003,3809,1384,3516,539,3984,2352,2014,603,2370,1494,2882,400,3306,1732,3375,2102,2637,2959,2865,1748,694,3056,3085,856,811,3299,2553,875,3867,3714,1050,1854,1354,1971,3216,2660,2602,3600,3780,38,884,402,2443,2380,1873,3003,2906,2937,1807,1211,2331,605,2212,608,3409,1823,2781,12,3042,3949,2201,1582,2280,151,1232,3112,323,2187,3405,2836,2664,2978,1442,899,4063,2646,247,4072,2407,1925,1475,2578,3296,2338,752,3063,2217,3564,3184,3994,2740,946,2730,3430,2189,2336,542,2262,2199,3298,2375,1346,723,2666,2761,1233,75,3673,2790,1015,2001,2984,2021,1855,526,2311,2133,507,384,3074,3239,3607,3507,3895,986,3789,2068,3657,3357,2862,3148,1132,690,3927,3760,2585,2224,2860,533,3745,1563,3092,1325,2821,2956,2640,2093,1013,3154,155,760,551,761,406,1825,2223,4075,2550,579,3738,1311,3671,292,1946,3509,2697,1382,2048,44,4012,432,537,3262,806,2272,3874,3116,433,2348,2642,2647,1897,1068,2596,3991,1995,1236,2247,2145,1571,835,129,334,883,598,2938,2043,2690,1711,565,1907,407,1627,197,2620,3468,3485,1680,1682,1327,3337,3840,3907,3529,990,293,332,2372,2672,804,2677,1222,35,888,3835,3575,1480,2920,3777,1876,3494,1749,3412,1148,2430,3388,2355,2142,3030,2395,1731,242,1443,572,2652,3259,1395,473,2170,936,3920,3145,3879,993,2367,2706,2185,2518,2132,185,3637,1023,2674,2097,3130,3977,252,2066,497,2632,3569,2549,898,1000,2095,2829,1309,2326,1526,1126,643,3698,3242,2631,1918,3360,2985,3161,3272,283,361,3014,918,1654,1851,1095,1104,3373,2012,55,1506,823,352,1425,2139,3104,2419,3029,2117,595,297,2276,3160,3459,2297,1365,506,842,3241,1981,1664,3270,3266,3645,994,1343,267,1079,3281,2044,2188,525,3397,2599,2522,3964,2575,3734,3650,335,724,3561,3941,3289,3317,2858,1001,3796,633,2508,1784,3598,2105,2940,527,3983,2203,1634,2705,3670,3141,1300,362,2879,3534,2936,3341,2293,1497,2220,3009,952,571,1651,2088,1347,3433,601,3258,4091,3051,1725,1714,1071,1702,422,3328,1470,1941,743,3709,3532,870,672,4067,2993,3963,2968,1605,2927,1305,2986,2420,3976,3726,3605,1319,1547,2806,739,1533,3442,818,271,2753,3131,1265,509,108,1755,3755,2686,2081,2764,3627,1566,2085,3499,851,3324,3326,295,2195,1965,86,230,3369,683,970,2823,1180,1994,3476,2901,3012,42,1028,1663,1466,1077,3402,165,756,661,2876,3191,3100,3005,3211,3997,4005,3218,2418,3225,3023,628,1874,3871,2004,3842,2793,1900,2554,1254,2752,728,521,1593,3711,4040,4064,2323,2584,4038,3418,912,3604,3502,260,199,2316,2916,1498,516,1719,862,3594,779,3235,1127,589,642,209,3384,3647,3731,1797,3570,1087,440,1516,194,859,1118,330,1867,2360,80,512,2232,1138,2489,2111,3079,1551,3806,3744,831,4028,4076,2344,1952,2125,1217,1331,2053,287,2206,39,1012,415,3736,995,2455,78,3015,2980,1730,1134,1853,1416,2329,3980,1417,228,364,3892,435,1837,288,1195,2924,1243,2995,3332,2036,877,977,1703,2866,1178,3872,1880,2510,1119,2802,3441,3757,2278,2593,3643,2273,150,2402,3940,793,2501,1575,1656,2859,787,2987,1904,622,58,48,1866,3665,1464,3952,1632,3903,1948,1536,133,272,3868,841,2397,3701,1729,2051,1780,2240,3587,2871,1017,3864,2759,1190,2481,3297,3695,3443,193,3406,2160,2615,1760,699,3783,3635,1584,2869,3036,563,1635,1496,312,1490,2815,522,3333,3068,84,685,4056,3095,3264,1544,863,822,1972,2436,2700,3278,3715,4084,2386,750,1323,3137,2962,4045,3566,1761,511,1157,1992,3679,3897,1301,1594,2330,1225,2148,3422,282,2373,370,1205,2322,803,748,1160,824,3144,2934,4023,1058,1324,544,854,2365,136,1291,3146,1503,30,2609,3700,3706,2561,3456,336,3362,349,1771,3071,3181,1525,2597,1616,2468,2855,2918,2112,3813,1910,1758,738,706,1576,3807,3553,2760,1889,3845,2103,1951,989,2463,1130,2446,3198,2811,4055,610,1753,2805,819,2828,3996,635,3928,847,4068,3567,2149,1262,1985,3894,632,1420,3002,1942,377,4066,3749,3651,4073,1954,3276,3453,2010,2946,2756,113,3707,1164,2983,794,1448,1606,3486,592,735,213,1988,321,475,1757,2009,2478,2424,3611,3117,3490,2414,568,3086,775,180,669,1770,2733,1361,3462,1945,2541,3454,1419,2335,980,3199,3111,1073,1108,132,111,895,2574,2654,4025,590,2404,3461,2719,1924,1935,2270,1051,2116,2795,3597,3093,2870,37,470,1458,1955,1977,1374,1895,2958,2530,1198,1660,2601,3318,3139,2136,2441,1808,903,3064,869,1542,1064,1518,3799,3312,1184,569,2488,3782,2108,809,640,1600,667,3449,307,3254,10,2222,1831,2630,3808,2138,2523,359,1609,1399,3669,2684,3287,1219,2736,3829,1912,3390,2769,2902,314,3622,1045,677,291,3129,1317,3950,1559,1667,3914,1471,839,817,231,1083,3539,2115,3898,1315,3053,1928,444,2388,2226,3944,1332,2324,186,3044,850,662,3301,4039,184,759,1723,443,1223,342,1639,1716,3277,65,2168,2471,1113,3126,1487,3285,3162,2496,3617,3756,3228,3628,1926,2083,2284,1637,3800,1210,3526,3888,147,2907,3366,2514,187,1282,2552,3232,3549,3821,3358,83,3348,1238,16,1093,2546,2651,722,179,1277,3696,2669,767,1260,2777,3028,2007,1739,3825,169,369,3351,1540,3471,401,963,3774,1142,1072,3708,1788,455,3959,855,3414,646,704,2512,1871,3135,3367,3855,2243,2209,1038,2626,2067,3054,2502,1717,4060,1858,3470,304,2704,2791,1879,8,3250,2595,464,4046,306,693,660,999,2950,2250,2294,2945,236,224,2175,2176,1444,3517,1581,1527,1373,3246,612,3904,98,2639,2052,623,3479,2974,2161,485,1775,1620,3083,1342,1968,5,391,2712,1681,3365,4017,1984,2964,2957,2519,1276,4021,3386,1800,3380,1501,3644,1390,3979,419,2886,3269,3000,56,2229,1849,232,3735,1899,3658,931,2762,2440,1969,1626,2817,1642,950,1894,140,1031,2180,3659,3682,34,1624,2912,3419,1005,174,4004,2482,2130,609,1052,2726,812,3226,3788,350,1098,953,3006,2513,3572,4085,116,3826,452,873,2288,3883,3869,2992,3765,3340,2757,1465,2699,3069,1841,2949,1350,1451,2588,764,2784,3601,2011,557,1123,736,2200,3122,3084,3932,106,1715,1549,2082,248,545,2548,2515,3151,1684,1024,1964,3203,1438,3705,2368,2409,2302,393,2484,195,3119,1508,1394,1421,405,412,4034,1978,1617,2491,1868,1509,2528,2089,944,465,1675,67,2040,3452,481,616,3075,925,4051,687,2041,1407,363,1796,4015,928,1447,2290,3787,1294,492,1592,2547,772,786,1683,1339,1601,1341,1690,2061,3584,2405,3573,4030,2979,4088,901,496,3615,3721,2786,1803,168,2016,3943,2289,1144,2722,1337,31,2521,2948,3127,2006,1790,15,1272,1307,51,2146,3271,1892,3438,3407,2638,1152,261,3624,152,695,397,3061,666,2970,375,969,1022,3661,3377,2801,1336,3763,1938,18,4081,663,2267,2679,3024,3109,1002,2413,1308,1020,275,2716,3321,3844,939,243,135,2572,1235,765,3697,4079,923,3022,832,733,702,326,3123,1923,1434,2996,70,3368,1857,3381,1658,1220,3916,386,3902,1521,3518,115,1285,1510,294,61,2309,1792,3638,942,1673,861,3460,6,47,3481,3169,619,3831,2235,3522,3309,3314,3472,1795,4080,2049,3303,1197,3728,1065,7,1226,97,2122,1149,1653,2065,2022,1805,2363,2390,3562,1738,14,2905,2351,1334,3822,4,3372,2483,2225,3421,3423,2028,3778,3953,1411,1905,3547,192,1863,897,3939,556,620,581,1318,3641,1014,4070,2653,2854,3882,1782,2184,1139,1940,3761,3519,3961,2143,2058,3209,3248,3804,354,1982,3965,2734,1302,2835,3192,1523,3090,2535,1092,239,204,2385,2230,2643,945,716,1915,2600,1886,2461,1385,3255,1580,1216,2260,3037,2952,2591,489,1455,2073,1387,2361,1672,3746,1154,2026,645,3770,3571,2310,1097,1431,3034,3816,2590,4009,1273,1804,353,3750,3634,2739,2537,4032,3187,1363,484,2107,1476,2878,720,3540,3896,805,4027,3812,1230,3849,3667,3008,1550,1202,1756,876,471,3016,813,1314,1607,1424,789,2608,253,871,2644,1646,1081,3331,1710,1167,843,2179,3076,3411,1877,3786,87,3960,421,955,996,1016,2152,2702,1893,4036,1569,3797,3178,2526,3581,1231,1264,1248,3237,1143,1718,347,1767,1944,1640,729,1275,2868,713,3055,582,966,17,3182,416,144,2724,1165,2890,1412,636,2771,109,3913,2015,491,1882,1070,1884,3021,3686,2539,3559,915,273,696,3206,2971,3614,2120,3194,2594,2242,1991,1787,420,1252,853,3668,2377,3802,3263,189,79,2832,2587,1577,1209,3596,3853,3128,2283,343,270,3610,2353,62,2579,586,777,2612,2894,3114,3720,2754,1140,1297,2507,1364,2750,2849,122,2662,3589,2635,2691,2989,2391,3205,2770,3646,860,2171,373,114,3208,1793,1574,1888,4031,2050,63,4018,142,3189,284,411,2124,1932,917,3371,1901,1187,531,1676,834,2327,3827,2738,2166,3875,1499,69,3078,1401,4047,1292,1124,3018,2850,1921,1708,462,1511,2315,2060,701,1850,3535,606,1437,2493,792,1610,33,27,639,3724,3057,88,2577,1597,546,319,2005,2883,3359,1485,2774,118,2234,190,1181,2101,3305,1398,141,394,3974,2633,1638,3861,2110,320,707,3025,1773,2717,81,1240,3342,3389,3436,153,1535,472,916,868,1917,3140,3810,2291,2432,3533,956,1046,3204,4061,4090,4019,2454,921,2648,434,3856,3703,3378,3087,776,560,2842,1806,1175,1426,3870,1076,4029,2942,1745,1699,673,4014,2610,198,202,2456,2046,1706,2583,858,3156,763,2383,3500,1920,3482,658,1987,1689,982,2966,3383,2156,303,2863,4016,2650,3621,2442,3729,604,278,2994,1875,2387,380,2208,3922,880,1229,1688,1328,2779,1320,1701,1286,276,2196,28,4007,3338,2563,221,1691,2782,2159,1269,978,1997,1011,1194,674,29,262,3491,2401,2628,3955,1129,766,1213,559,2092,1966,3174,4011,3059,3620,1402,3951,3712,714,2246,3080,3329,2533,3909,1193,3188,827,1962,3531,445,3280,3524,957,1030,1099,3043,1241,954,2618,1553,1734,1488,808,371,418,3893,3356,2381,1789,788,730,3463,121,19,451,2919,2701,92,124,4049,403,2765,2977,2573,3576,2804,1548,3593,2671,2376,840,4078,311,385,461,1916,3094,4020,2210,3483,3019,1726,2018,1914,316,2767,2743,1504,2891,374,41,1044,3968,2867,3313,2973,891,178,2941,1150,1377,2814,2843,3545,1393,3603,3766,3227,212,3805,3817,479,3838,3335,1060,3848,158,1754,3260,1709,355,1737,2433,578,1428,1100,3693,1999,3716,2127,3233,2451,1812,3577,1802,277,583,1174,1483,2663,2038,1603,3506,1461,3791,621,436,973,3691,3492,528,3166,3286,161,468,3497,2253,137,1117,700,250,998,53,2723,2603,279,3448,3354,1452,3739,22,833,771,3713,447,3291,2312,2745,1694,2598,2411,2580,1859,1622,4086,3013,308,2888,1454,3865,3229,296,2932,1589,3469,3542,3586,376,1357,872,2403,1267,1179,1392,1101,2033,2904,1037,597,2304,647,1647,1534,1409,241,1048,3962,1338,3125,348,1885,983,615,1280,3177,602,711,802,2084,1665,846,1274,2856,2713,3101,613,3050,148,3240,948,1774,3773,3655,1524,1846,2027,1980,1778,2415,1263,2426,3487,2227,60,1088,1728,3676,2604,762,968,234,2694,2314,1415,3175,372,836,2473,3444,2988,1554,4052,1345,971,3302,2193,3103,3557,514,1950,692,3654,3214,2625,1039,2715,1389,3010,2568,3325,3530,3508,21,838,3136,927,3467,1720,2619,3640,520,2029,2047,382,1036,3247,2221,3363,965,2467,1170,2885,2213,1057,659,1998,3355,317,3747,3887,4074,2914,2982,3196,3346,652,1283,1697,845,1182,3933,3429,266,2875,3602,64,1983,3425,941,3222,3293,2364,678,926,2305,285,562,1010,2833,2307,2233,3220,3609,327,3120,2504,1648,3244,457,379,3164,2967,103,1383,3642,751,1712,3207,2162,2416,2963,1489,3793,3966,3385,3150,1931,181,742,698,1271,3546,1696,1355,552,3426,2524,1244,3754,1864,1249,2665,2511,3543,3885,2447,919,3288,934,1055,3300,345,3830,2282,2763,1445,867,2877,3565,1495,2265,4033,532,3213,257,3795,712,1306,3067,3818,2431,2834,2544,1056,1507,2003,2128,171,387,2465,774,1869,1618,829,1351,226,1376,1848,981,3733,229,398,219,3846,1321,626,477,2892,1089,3536,1903,490,4057,2123,2831,1633,1212,1659,2797,1772,3035,1623,2054,2729,2264,2080,614,1661,265,599,1862,684,453,2090,2263,2042,1352,2458,3847,3155,2460,1009,1353,2933,238,3852,1413,365,3858,3631,3417,3439,367,2255,3352,203,3048,2925,2780,611,2428,907,3253,1809,1457,2396,3969,3163,3881,4054,2341,757,3973,2359,3743,2930,3626,1492,126,4082,2611,2487,3,3675,442,3725,2792,3307,961,2693,1832,1462,2394,741,2236,987,2861,3558,2340,32,2960,494,360,3956,2772,1043,3513,43,3945,943,1662,1400,1769,1834,2412,878,2319,1742,3168,949,1391,1587,2192,2687,2627,3636,1830,66,2285,2077,1340,857,1668,648,885,3751,3934,1128,3972,2062,2807,3514,3552,3308,1432,356,3379,1801,2448,1018,3091,3176,3045,536,1963,423,101,3911,3781,3215,892,2277,2732,2703,220,2853,975,341,2725,128,3185,2506,2565,3183,1746,3077,1989,1599,1257,2438,1279,2064,3978,3926,2332,2520,3040,849,1418,25,183,2570,450,1491,1379,882,2617,3361,3753,3582,1441,1752,2249,3282,3656,182,408,1847,3737,2183,964,3748,1844,3560,3579,2157,3410,1890,1822,1312,1829,3987,2629,3311,4037,2486,392,958,798,3850,2317,3585,1839,139,1591,1021,1615,3685,448,2181,366,3717,1396,2822,2698,2893,937,1810,3851,200,3320,1484,1486,3616,3924,1061,11,3464,3986,2727,2464,2023,3066,1054,1215,2564,1835,1583,900,2621,2480,2086,3400,3886,4094,1979,1449,3257,679,1460,3505,1705,1929,2692,1532,4002,1619,3399,2358,99,3583,3274,2516,3674,1724,821,3364,1367,3330,933,2990,2645,459,3408,781,688,1974,1939,2169,780,3704,2851,1091,3026,2410,960,305,2393,2239,4022,3925,71,3032,1512,3722,1171,2944,217,2737,785,886,2369,2356,705,2566,726,2114,2298,2954,2555,1456,1679,3771,3612,501,1686,1242,1936,1004,123,801,2457,1450,3058,3992,237,3768,3322,1067,143,1200,2976,2525,205,1344,446,1153,825,784,381,2362,1114,2559,2045,3937,1196,4008,504,2072,2800,3970,2429,425,2503,500,2150,3336,1519,2074,2688,3200,2286,298,2827,1359,3167,717,1293,2923,1162,1628,439,3815,222,54,424,1062,3839,3606,3134,2055,2154,3173,1034,2228,2261,3027,3935,1041,1386,3252,3065,2308,208,1482,1029,1552,1115,3062,50,874,1906,548,1256,0,3004,3451,2997,2453,519,1247,1588,91,258,564,3447,691,844,3776,1611,2613,1075,2787,1781,3946,991,682,3195,2874,3866,2256,1053,3917,908,3915,2452,2357,2075,2571,2389,3958,1281,1860,1107,2252,1695,962,573,607,721,502,315,1493,430,2718,791,2197,631,2057,344,940,3157,2766,3334,2714,264,1625,396,1405,2586,574,2744,3267,3398,3392,2024,90,3740,1439,1811,1520,3265,1106,3653,166,2775,554,2809,3219,3484,3295,920,2303,2445,1919,3437,2211,1722,3273,744,2035,2275,3578,2019,1815,3811,207,4095,3639,1817,909,1381,1298,997,3899,1177,1669,3283,3347,1505,85,2852,588,2096,3049,852,3772,513,709,967,3223,1572,1556,807,1025,1362,1700,3416,2911,3343,259,2186,1,340,3149,2667,1006,2153,1473,896,2384,1568,913,1537,992,732,3284,3489,2661,149,2400,1019,1474,2534,2013,1121,3999,2634,429,1779,2427,1655,3261,629,1735,3106,4024,3794,4000,3488,627,2444,894,1783,3041,2425,2616,1590,1818,1246,1304,1937,2939,460,3873,3563,2622,3370,20,3680,2421,1870,289,910,102,3678,119,2711,3929,3212,1429,3038,2915,478,3420,3279,3457,2794,2218,1692,1125,3466,1109,2926,3954,3741,3088,1902,2119,515,77,322,1186,1086,3165,1206,2492,3243,3521,1565,3718,414,1865,3710,4069,2675,223,163,2354,3985,2318,3556,1881,107,1578,2296,1151,580,300,1008,2378,1953,3544,2943,2158,675,3727,2155,2466,3349,357,3427,668,3179,3474,783,3201,1973,1649,1546,1678,1112,2678,188,2299,469,2560,1201,600,1284,2392,3455,76,1891,388,2071,1430,26,591,23,1819,1027,1085,2437,1253,654,566,3819,1824,2545,3877,830,1768,1908,3133,2237,3625,1558,2337,3801,2214,3099,1423,3876,1203,1513,1573,576,2826,1515,570,3971,3595,4043,3923,2000,1026,1453,3823,3841,191,3989,1133,145,550,235,3039,1335,3792,540,4050,1066,2450,476,3495,3323,2848,1636,979,3428,3404,2825,3458,3550,2649,2470,274,3249,1785,2173,1459,1947,378,1813,59,984,2398,2798,1155,3931,2846,1360,681,2462,541,3664,1169,1794,1670,799,1514,40,1261,2921,2749,1612,2881,887,618,2257,417,1090,2472,985,105,3599,2087,1909,2551,480,3591,2056,2741,2567,1883,553,3046,3767,2689,1221,745,3649,3689,4041,3666,1250,710,2191,2325,1199,1562,1564,1733,2908,3790,3256,1922,3862,3723,1836,3854,3947,2008,3699,154,4087,458,2063,503,708,2887,1074,1330,2475,815,3820,625,3719,1228,2636,650,547,89,1687,3730,2328,395,3702,2607,1898,929,1598,826,3245,951,1078,73,2274,1467,240,796,2685,3681,1082,1517,1629,1856,3153,2558,3236,2812,1541,1440,2076,301,225,881,3113,2241,2955,100,134,1996,3890,96,4065,3159,1375,2098,454,1585,3374,3684,399,2929,9,351,938,1116,731,2301,2623,3446,1380,3107,1538,2371,2079,130,4059,510,1943,2118,1799,1049,413,1840,3687,431,2998,474,3995,2474,754,2972,3319,1976,2840,664,358,1993,649,2873,2768,404,3060,1239,1110,3779,2204,1764,3339,3878,1959,624,768,3900,3415,2847,1463,1896,1842,3692,778,1528,1403,3473,2889,795,1299,383,2810,2109,1310,2695,2147,1707,734,2527,3511,2406,201,2268,3394,438,338,911,2151,3857,280,2531,904,2435,655,1693,2382,164,3798,1579,865,3110,3901,3234,2880,1007,561,2896,3775,1145,3480,2034,2910,3672,3115,437,890,1765,577,2126,3210,814,1828,2490,1958,160,3268,3837,2581,2254,2339,2900,2347,2673,2279,753,1141,680,2269,3990,3663,1120,2140,1557,3551,3504,325,2165,2350,972,2399,2656,3785,1721,585,493,3310,1472,1798,3017,1934,837,310,1348,3186,269,263,2562,3387,2167,2182,57,3395,1259,1861,3304,1063,1522,3431,302,3938,2177,567,1827,2728,2658,3905,2820,820,1685,2202,816,2216,594,125,1479,2306,3588,1227,747,4044,617,689,1957,3690,2538,2164,1156,2141,2947,3998,538,72,529,2287,2999,769,2017,1741,157,2207,409,1631,290,3548,988,644,3828,3290,483,3217,740,3613,1975,3202,3515,2951,2864,914,703,2532,1159,930,1933,1168,4053,3121,196,1313,879,1224,1816,4010,3142,346,3803,1744,2536,3118,517,596,487,1776,2803,1270,575,518,1677,1613,2078,3683,1290,117,1329,2163,1643,3957,1766,505,2025,935,976,2808,4093,3315,2321,3073,1322,4092,1326,2776,718,3834,3982,1777,1136,2670,1531,1378,167,3554,922,1433,3493,24,339,749,2039,1042,3908,2721,651,1436,1189,2320,3345,1838,3688,3814,2094,1545,463,1366,555,3967,1608,2899,1644,1105,211,3132,2818,1035,1295,737,3752,1543,3930,3537,2813,2747,488,2614,746,3677,3496,2334,2137,206,390,3784,2676,3574,1397,2295,2497,1435,2913,499,3694,2266,127,670,2816,309,3824,634,593,3555,3859,3393,1698,2708,1960,2494,2031,1478,3580,1192,530,1970,1096,1602,3590,4062,1652,146,3147,1641,1949,1370,1446,2589,1288,244,1481,1666,49,2965,2251,2655,3197,1740,1814,1872,656,893,2748,162,584,1671,3884,498,2755,1930,3098,2576,3769,3632,932,3047,1567,313,1410,686,3836,4077,46,1529,2657,3618,3435,1349,2969,281,2788,1595,2529,1135,2343,1469,251,1763,256,2313,3520,1560,1759,1371,2838,2476,2032,3912,1255,1743,1303,3190,3193,770,1406,1358,1956,1289,3072,486,3936,1103,214,4006,1751,3921,1368,2680,2799,2,697,2100,3011,3082,1843,782,1080,3629,3316,3981,1727,2219,138,175,1539,3171,2238,2841,95,1278,3503,4035,2366,495,2333,715,104,4001,245,1172,2434,2592,2498,1369,456,657,1122,773,466,3608,2500,3105,2778,3052,2258,1561,176,1251,1422,94,2194,68,947,2903,3413,2104,2106,1191,3432,1266,2683,3230,2641,2922,2422,3525,449,1990,328,3988,758,1596,2248,1214,725,3538,4058,3652,1296,1084,3742,1852,630,3759,3541,13,3523,902,3512,1477,3843,924,2037,4083,2789,2178,3880,3860,1586,2131,2190}; 
static	const float				randN[4096]	= {0.40536f,0.0132654f,0.630658f,0.547987f,0.132128f,0.482789f,0.570651f,0.594256f,0.864749f,0.106682f,0.757909f,0.168957f,0.102531f,0.0136439f,0.811577f,0.287452f,0.874755f,0.836685f,0.852981f,0.287892f,0.541242f,0.345706f,0.430295f,0.256198f,0.19247f,0.187897f,0.0221892f,0.0575776f,0.572065f,0.172099f,0.475916f,0.264934f,0.985497f,0.803206f,0.258655f,0.384339f,0.0080771f,0.977972f,0.718833f,0.556448f,0.635491f,0.510681f,0.532999f,0.936991f,0.741457f,0.748181f,0.687777f,0.25066f,0.954209f,0.267768f,0.266981f,0.755002f,0.780955f,0.511055f,0.531047f,0.535869f,0.271956f,0.310234f,0.837073f,0.763299f,0.887078f,0.533325f,0.118908f,0.834209f,0.886814f,0.670343f,0.743172f,0.659302f,0.660583f,0.433648f,0.0355097f,0.47297f,0.24749f,0.0447804f,0.832645f,0.232863f,0.655068f,0.167976f,0.168439f,0.3738f,0.284274f,0.277206f,0.402224f,0.704882f,0.63524f,0.453321f,0.514104f,0.157655f,0.893381f,0.188779f,0.303227f,0.763325f,0.725619f,0.46238f,0.355752f,0.71416f,0.460994f,0.381693f,0.288252f,0.00665791f,0.674152f,0.682545f,0.151391f,0.0592752f,0.337122f,0.317091f,0.886864f,0.822932f,0.0204182f,0.14544f,0.375957f,0.223801f,0.0203754f,0.855482f,0.516164f,0.266361f,0.182175f,0.680811f,0.409819f,0.0164857f,0.6599f,0.515265f,0.540041f,0.565f,0.904132f,0.54158f,0.971087f,0.625809f,0.84542f,0.945167f,0.42534f,0.909722f,0.341216f,0.9949f,0.931969f,0.591261f,0.433944f,0.195973f,0.67672f,0.892202f,0.920759f,0.760504f,0.552769f,0.26802f,0.342819f,0.841655f,0.650549f,0.0793233f,0.941334f,0.927347f,0.099204f,0.27839f,0.991992f,0.981284f,0.725762f,0.964194f,0.532156f,0.482888f,0.194636f,0.646051f,0.852609f,0.939993f,0.441638f,0.765785f,0.876852f,0.11013f,0.553463f,0.23006f,0.717221f,0.767563f,0.80434f,0.275868f,0.590911f,0.615888f,0.322697f,0.447796f,0.047398f,0.648742f,0.594635f,0.391875f,0.863313f,0.880589f,0.874062f,0.72841f,0.515305f,0.749939f,0.9252f,0.955686f,0.313529f,0.597399f,0.683743f,0.988606f,0.919369f,0.857772f,0.623851f,0.0163969f,0.575076f,0.768295f,0.133136f,0.603071f,0.619122f,0.203766f,0.426004f,0.742698f,0.571434f,0.237408f,0.376186f,0.126151f,0.477677f,0.734304f,0.407559f,0.242321f,0.762207f,0.774161f,0.734718f,0.23816f,0.344133f,0.948567f,0.856455f,0.342798f,0.356069f,0.0824285f,0.497276f,0.129038f,0.201359f,0.265658f,0.582722f,0.718576f,0.173665f,0.220713f,0.2838f,0.430365f,0.173947f,0.855336f,0.173855f,0.775033f,0.498496f,0.693436f,0.673725f,0.811851f,0.964608f,0.619268f,0.149387f,0.127449f,0.56708f,0.565592f,0.527034f,0.257129f,0.145223f,0.813759f,0.951517f,0.771053f,0.351055f,0.90558f,0.929792f,0.0229858f,0.267219f,0.30722f,0.442862f,0.48983f,0.814699f,0.454425f,0.776219f,0.256501f,0.411789f,0.890552f,0.897118f,0.393626f,0.848647f,0.230927f,0.238573f,0.628644f,0.804463f,0.251607f,0.163923f,0.210409f,0.537285f,0.130808f,0.231121f,0.0330077f,0.34439f,0.991408f,0.225307f,0.0673784f,0.402065f,0.763938f,0.690623f,0.690702f,0.723447f,0.656025f,0.869561f,0.570043f,0.504861f,0.982282f,0.60239f,0.0635944f,0.482983f,0.900882f,0.416946f,0.704295f,0.213665f,0.25684f,0.51718f,0.843221f,0.306126f,0.647307f,0.640868f,0.903073f,0.840872f,0.709046f,0.463213f,0.446511f,0.384214f,0.350284f,0.0354826f,0.17678f,0.67615f,0.823951f,0.226272f,0.166096f,0.997475f,0.781955f,0.206447f,0.15674f,0.548714f,0.0779438f,0.245482f,0.726131f,0.495399f,0.0719368f,0.385976f,0.596501f,0.132053f,0.753674f,0.289808f,0.517324f,0.0461426f,0.554468f,0.699902f,0.837237f,0.622903f,0.0393381f,0.212492f,0.0482442f,0.291958f,0.856921f,0.291781f,0.91485f,0.454984f,0.517214f,0.281708f,0.0791905f,0.720557f,0.853415f,0.366847f,0.552236f,0.367734f,0.452734f,0.431505f,0.487968f,0.449523f,0.449735f,0.560265f,0.0592358f,0.0514759f,0.194958f,0.84022f,0.626104f,0.351034f,0.245474f,0.377508f,0.872875f,0.774046f,0.0449278f,0.490183f,0.780194f,0.389448f,0.661713f,0.917635f,0.842273f,0.412829f,0.729047f,0.639103f,0.521109f,0.118912f,0.952013f,0.806831f,0.377765f,0.0633589f,0.509976f,0.583341f,0.683345f,0.314469f,0.140698f,0.0811469f,0.223966f,0.933176f,0.248077f,0.903063f,0.674807f,0.043902f,0.349074f,0.701933f,0.392928f,0.588514f,0.658489f,0.401767f,0.59493f,0.0368943f,0.466534f,0.487066f,0.649492f,0.463184f,0.811133f,0.351949f,0.48945f,0.984965f,0.713313f,0.863835f,0.306715f,0.763511f,0.317072f,0.118403f,0.642507f,0.195853f,0.948217f,0.967926f,0.42411f,0.38198f,0.13712f,0.16987f,0.561118f,0.346544f,0.0574685f,0.288789f,0.5155f,0.572817f,0.829119f,0.537862f,0.906812f,0.996821f,0.559053f,0.693658f,0.850926f,0.469655f,0.496012f,0.952116f,0.583203f,0.349448f,0.304768f,0.0218798f,0.644226f,0.741218f,0.112147f,0.903783f,0.525274f,0.175391f,0.268547f,0.0569967f,0.854457f,0.461645f,0.113077f,0.242426f,0.584996f,0.280237f,0.278108f,0.545184f,0.904226f,0.325969f,0.366406f,0.0573732f,0.125669f,0.516352f,0.175533f,0.314206f,0.35901f,0.0224386f,0.247858f,0.198805f,0.583498f,0.439527f,0.514051f,0.258923f,0.0499842f,0.521033f,0.142769f,0.525555f,0.194281f,0.668298f,0.830494f,0.362824f,0.371172f,0.109261f,0.751383f,0.753819f,0.776937f,0.19207f,0.105404f,0.79436f,0.421593f,0.98767f,0.90131f,0.657233f,0.375398f,0.693389f,0.761343f,0.804369f,0.357321f,0.95483f,0.855294f,0.99625f,0.577195f,0.961672f,0.851237f,0.730126f,0.418805f,0.950523f,0.435508f,0.140986f,0.132778f,0.829256f,0.0451043f,0.638068f,0.664205f,0.682751f,0.240094f,0.400336f,0.708921f,0.137418f,0.374331f,0.753329f,0.275816f,0.0371254f,0.362137f,0.719777f,0.563767f,0.809228f,0.650125f,0.850093f,0.113122f,0.409769f,0.739528f,0.397151f,0.679829f,0.661731f,0.185344f,0.298153f,0.163732f,0.939885f,0.593674f,0.0162999f,0.514793f,0.125771f,0.811917f,0.955813f,0.491645f,0.233519f,0.256331f,0.0999622f,0.127017f,0.43837f,0.0190179f,0.0908779f,0.761167f,0.267231f,0.821806f,0.27904f,0.751997f,0.484301f,0.106138f,0.62392f,0.418318f,0.495218f,0.89428f,0.807695f,0.592891f,0.713012f,0.675707f,0.557772f,0.94916f,0.758398f,0.690755f,0.443006f,0.178975f,0.569131f,0.412126f,0.837462f,0.403494f,0.863943f,0.839102f,0.095715f,0.484356f,0.885165f,0.138636f,0.276466f,0.681108f,0.922949f,0.993057f,0.132042f,0.137914f,0.196194f,0.0520257f,0.16343f,0.492221f,0.731527f,0.323499f,0.898389f,0.933091f,0.140144f,0.82138f,0.784014f,0.416096f,0.544801f,0.270478f,0.918549f,0.52504f,0.0200817f,0.213463f,0.2789f,0.0764558f,0.0327602f,0.146806f,0.111188f,0.546316f,0.509571f,0.19056f,0.490628f,0.564833f,0.684931f,0.0695957f,0.78575f,0.240615f,0.661942f,0.760765f,0.0714264f,0.305539f,0.432688f,0.436892f,0.121412f,0.567359f,0.792742f,0.300797f,0.0871256f,0.177247f,0.259885f,0.492545f,0.796837f,0.31268f,0.0761863f,0.160852f,0.48883f,0.888052f,0.425312f,0.564651f,0.845013f,0.15389f,0.445616f,0.49036f,0.775038f,0.969392f,0.53064f,0.0781318f,0.105936f,0.409144f,0.00930024f,0.939986f,0.596617f,0.544909f,0.753165f,0.448816f,0.517676f,0.0650227f,0.147543f,0.0857717f,0.569208f,0.375255f,0.734129f,0.417823f,0.117525f,0.384407f,0.0192803f,0.942106f,0.250237f,0.645307f,0.623057f,0.47272f,0.200681f,0.970577f,0.648483f,0.483634f,0.594397f,0.468045f,0.243901f,0.833992f,0.912886f,0.816704f,0.48173f,0.877163f,0.0181636f,0.753486f,0.830408f,0.937425f,0.442133f,0.99793f,0.667202f,0.946824f,0.318945f,0.782248f,0.84669f,0.448809f,0.428031f,0.56249f,0.464313f,0.387892f,0.770574f,0.566295f,0.406456f,0.0561218f,0.778976f,0.612411f,0.930241f,0.610351f,0.86679f,0.452633f,0.735977f,0.310091f,0.579122f,0.16288f,0.823262f,0.697828f,0.498691f,0.616142f,0.346866f,0.519947f,0.546496f,0.906773f,0.205143f,0.109405f,0.0976699f,0.697512f,0.370698f,0.19849f,0.576986f,0.411123f,0.163977f,0.712771f,0.344516f,0.643391f,0.471114f,0.310736f,0.960999f,0.223579f,0.0607039f,0.265695f,0.386123f,0.322049f,0.39329f,0.302176f,0.715875f,0.431189f,0.594112f,0.903368f,0.139008f,0.11185f,0.812694f,0.176211f,0.517495f,0.0591685f,0.453517f,0.715177f,0.163892f,0.166061f,0.244048f,0.229581f,0.972638f,0.549787f,0.7901f,0.349966f,0.28993f,0.861854f,0.993741f,0.300199f,0.508387f,0.555152f,0.739501f,0.791607f,0.483547f,0.635883f,0.793655f,0.13669f,0.200346f,0.0114699f,0.52601f,0.824337f,0.622055f,0.433253f,0.0876225f,0.487117f,0.195136f,0.825919f,0.517628f,0.656313f,0.830416f,0.646453f,0.410642f,0.668677f,0.725488f,0.292046f,0.514379f,0.803308f,0.494846f,0.946879f,0.473981f,0.29887f,0.820225f,0.916859f,0.236254f,0.497041f,0.542634f,0.76415f,0.628422f,0.577413f,0.118611f,0.964968f,0.030463f,0.159246f,0.116769f,0.563813f,0.705593f,0.521748f,0.165716f,0.1498f,0.868803f,0.0566612f,0.894678f,0.0350277f,0.974989f,0.65968f,0.299421f,0.472811f,0.441846f,0.12559f,0.610069f,0.0158951f,0.369607f,0.253083f,0.0955178f,0.492205f,0.698678f,0.625518f,0.813388f,0.265652f,0.218805f,0.192989f,0.848896f,0.277919f,0.968034f,0.0971729f,0.995936f,0.38455f,0.641175f,0.882846f,0.615067f,0.88029f,0.633547f,0.85746f,0.685311f,0.0194431f,0.289558f,0.400811f,0.621126f,0.737756f,0.322586f,0.623637f,0.360435f,0.233382f,0.00924081f,0.0611808f,0.271135f,0.810522f,0.233855f,0.456025f,0.401682f,0.405025f,0.354731f,0.617953f,0.777871f,0.375153f,0.221954f,0.316972f,0.457775f,0.245001f,0.434931f,0.901185f,0.440487f,0.0846721f,0.722852f,0.0245135f,0.841951f,0.226736f,0.336137f,0.0353874f,0.259805f,0.205242f,0.263339f,0.962463f,0.773963f,0.753073f,0.279643f,0.740722f,0.66815f,0.644282f,0.713096f,0.139383f,0.599351f,0.0423319f,0.706687f,0.224013f,0.400187f,0.785049f,0.560084f,0.102189f,0.980668f,0.648666f,0.785541f,0.130854f,0.962242f,0.637796f,0.705337f,0.976216f,0.151456f,0.184639f,0.137405f,0.262566f,0.753365f,0.536837f,0.974312f,0.617429f,0.630491f,0.0639864f,0.734025f,0.0656053f,0.0784328f,0.181907f,0.0167962f,0.0510526f,0.179664f,0.829381f,0.702494f,0.761714f,0.935646f,0.839413f,0.679342f,0.260602f,0.402702f,0.452095f,0.152979f,0.692819f,0.66725f,0.938139f,0.305211f,0.277182f,0.192245f,0.662004f,0.122958f,0.527157f,0.262191f,0.646083f,0.0557808f,0.709463f,0.886597f,0.891229f,0.300052f,0.235041f,0.451811f,0.916555f,0.139814f,0.797171f,0.628122f,0.694265f,0.924552f,0.353737f,0.472219f,0.452264f,0.400173f,0.191013f,0.747603f,0.499023f,0.62886f,0.607898f,0.186862f,0.848929f,0.916986f,0.714256f,0.628923f,0.387679f,0.937111f,0.755154f,0.0929858f,0.0756485f,0.693362f,0.332948f,0.403969f,0.502277f,0.6114f,0.0678165f,0.900306f,0.647544f,0.351265f,0.169696f,0.99544f,0.998797f,0.93401f,0.850375f,0.575657f,0.583901f,0.229469f,0.659794f,0.0976405f,0.959846f,0.879156f,0.485627f,0.1392f,0.952913f,0.71153f,0.270574f,0.617139f,0.874157f,0.564725f,0.687579f,0.287705f,0.0847213f,0.372627f,0.870338f,0.361793f,0.27083f,0.809024f,0.584027f,0.49222f,0.354672f,0.308156f,0.660646f,0.665199f,0.83558f,0.694215f,0.480228f,0.365955f,0.933398f,0.418866f,0.850163f,0.396474f,0.62977f,0.0113558f,0.97853f,0.696665f,0.505062f,0.841013f,0.808307f,0.356211f,0.40573f,0.534484f,0.466015f,0.781585f,0.841438f,0.191518f,0.384546f,0.424601f,0.360579f,0.435454f,0.230787f,0.408781f,0.534587f,0.322458f,0.933967f,0.766433f,0.50989f,0.914705f,0.207177f,0.974828f,0.434434f,0.522879f,0.409691f,0.949436f,0.53774f,0.434379f,0.952502f,0.839927f,0.760495f,0.332688f,0.264182f,0.663277f,0.199492f,0.192698f,0.158271f,0.09527f,0.540009f,0.171285f,0.28783f,0.619415f,0.423282f,0.364475f,0.288201f,0.390486f,0.826206f,0.0493623f,0.399111f,0.554772f,0.842038f,0.912324f,0.905755f,0.792366f,0.0182623f,0.904577f,0.604558f,0.545496f,0.222294f,0.583887f,0.436148f,0.469643f,0.582727f,0.823507f,0.660335f,0.160012f,0.601479f,0.301151f,0.129844f,0.476483f,0.71743f,0.869517f,0.0196231f,0.653235f,0.723402f,0.130591f,0.0447673f,0.293383f,0.101468f,0.731358f,0.427851f,0.25339f,0.00545277f,0.652593f,0.355386f,0.817361f,0.900074f,0.699039f,0.663982f,0.703227f,0.889624f,0.123061f,0.447442f,0.480949f,0.589633f,0.86145f,0.0571338f,0.925009f,0.391215f,0.90541f,0.843112f,0.993738f,0.255909f,0.0258312f,0.707142f,0.38254f,0.519665f,0.221361f,0.911996f,0.72382f,0.641584f,0.493433f,0.200757f,0.114777f,0.603113f,0.367337f,0.319498f,0.628998f,0.900649f,0.99806f,0.473288f,0.495882f,0.711285f,0.411202f,0.364395f,0.523489f,0.659188f,0.604138f,0.257059f,0.271971f,0.500489f,0.626603f,0.0255487f,0.903966f,0.736441f,0.828894f,0.459239f,0.203177f,0.256298f,0.41831f,0.441823f,0.838839f,0.334634f,0.76141f,0.160703f,0.61153f,0.799285f,0.128751f,0.027464f,0.128241f,0.0818325f,0.109615f,0.292381f,0.0959102f,0.729999f,0.206041f,0.51385f,0.248731f,0.644171f,0.220066f,0.397265f,0.354508f,0.41873f,0.83157f,0.37066f,0.640252f,0.275798f,0.997282f,0.786872f,0.94089f,0.430987f,0.673261f,0.541411f,0.396847f,0.242396f,0.789657f,0.118494f,0.957658f,0.159778f,0.25405f,0.524903f,0.0701807f,0.0823223f,0.180701f,0.347906f,0.486586f,0.0382979f,0.176207f,0.95011f,0.0821239f,0.806991f,0.178089f,0.0656163f,0.827589f,0.155249f,0.494412f,0.534439f,0.132868f,0.0353451f,0.714717f,0.419321f,0.710276f,0.859855f,0.0284672f,0.763896f,0.309868f,0.647243f,0.598353f,0.666482f,0.0188488f,0.734228f,0.192538f,0.648936f,0.932606f,0.729619f,0.321385f,0.253399f,0.5033f,0.615493f,0.280397f,0.702194f,0.669771f,0.634908f,0.542055f,0.885722f,0.522438f,0.85156f,0.0302683f,0.797699f,0.135603f,0.503915f,0.601397f,0.390969f,0.106784f,0.777417f,0.000304709f,0.86315f,0.523206f,0.896979f,0.152115f,0.731601f,0.649555f,0.452047f,0.287611f,0.396179f,0.573734f,0.984473f,0.215824f,0.798952f,0.406936f,0.135651f,0.834771f,0.0356444f,0.947928f,0.188652f,0.608813f,0.443397f,0.922008f,0.522402f,0.546498f,0.756689f,0.437727f,0.207823f,0.0297572f,0.229573f,0.841057f,0.644448f,0.0920675f,0.552346f,0.809539f,0.206128f,0.472669f,0.0712035f,0.537007f,0.04586f,0.345315f,0.793413f,0.682357f,0.485618f,0.0581793f,0.552749f,0.481452f,0.17481f,0.0618678f,0.0872186f,0.172102f,0.318402f,0.891384f,0.569681f,0.521402f,0.35009f,0.535194f,0.0525421f,0.449551f,0.16717f,0.450085f,0.314364f,0.0477339f,0.821337f,0.868351f,0.680022f,0.927306f,0.0682361f,0.0218184f,0.273403f,0.104827f,0.08509f,0.496655f,0.53064f,0.977991f,0.740756f,0.358104f,0.843515f,0.376802f,0.445946f,0.920173f,0.876853f,0.929331f,0.16826f,0.421544f,0.361809f,0.502219f,0.737495f,0.0231011f,0.722132f,0.432654f,0.511885f,0.649489f,0.143484f,0.645794f,0.134624f,0.028719f,0.291413f,0.626868f,0.232994f,0.115875f,0.986041f,0.252739f,0.380875f,0.247261f,0.977547f,0.150074f,0.992756f,0.272282f,0.731468f,0.309894f,0.9457f,0.836166f,0.0448259f,0.933672f,0.312416f,0.752407f,0.684147f,0.323719f,0.522734f,0.245303f,0.722677f,0.125353f,0.787878f,0.454183f,0.462282f,0.882745f,0.375991f,0.0338187f,0.148495f,0.6589f,0.557362f,0.346775f,0.952295f,0.276339f,0.677407f,0.878045f,0.0966374f,0.779167f,0.665155f,0.00208192f,0.474369f,0.400474f,0.511175f,0.91909f,0.36586f,0.938574f,0.460201f,0.506412f,0.732586f,0.863776f,0.47999f,0.50248f,0.625768f,0.860064f,0.736346f,0.904391f,0.999069f,0.77294f,0.0315951f,0.0959339f,0.308912f,0.426819f,0.657855f,0.3856f,0.934802f,0.49132f,0.836294f,0.362294f,0.249765f,0.503865f,0.434164f,0.522666f,0.919527f,0.0914235f,0.872464f,0.426763f,0.573794f,0.925958f,0.304865f,0.720477f,0.232231f,0.0323613f,0.990872f,0.24402f,0.0455601f,0.0345039f,0.880764f,0.931373f,0.380724f,0.221715f,0.984247f,0.986277f,0.91943f,0.218826f,0.446747f,0.820552f,0.0982048f,0.99091f,0.0742206f,0.0359809f,0.356767f,0.220367f,0.389993f,0.0510389f,0.124476f,0.883367f,0.683946f,0.654125f,0.0221024f,0.0416344f,0.91939f,0.722976f,0.491587f,0.38399f,0.352317f,0.726655f,0.641265f,0.657307f,0.794063f,0.636786f,0.866615f,0.839553f,0.878746f,0.693991f,0.558094f,0.400393f,0.262711f,0.479813f,0.993962f,0.442765f,0.528133f,0.563954f,0.0483302f,0.985407f,0.0626515f,0.550782f,0.438745f,0.265215f,0.344479f,0.0730709f,0.435417f,0.642814f,0.118738f,0.845702f,0.155561f,0.220744f,0.185441f,0.00923334f,0.5077f,0.838624f,0.913642f,0.585516f,0.726342f,0.831496f,0.520481f,0.20552f,0.992633f,0.313679f,0.37561f,0.707474f,0.71278f,0.412435f,0.828656f,0.0786779f,0.386781f,0.106975f,0.885339f,0.779329f,0.564629f,0.431395f,0.848527f,0.812603f,0.921873f,0.403486f,0.968231f,0.45115f,0.583162f,0.956809f,0.0676698f,0.0175723f,0.181122f,0.602927f,0.440902f,0.0940427f,0.0889994f,0.504327f,0.854576f,0.357992f,0.481996f,0.668154f,0.92863f,0.659347f,0.0762442f,0.065731f,0.422126f,0.388115f,0.687263f,0.322607f,0.987039f,0.955273f,0.0929966f,0.206722f,0.635399f,0.632667f,0.809434f,0.00711122f,0.499912f,0.24364f,0.794765f,0.830204f,0.811405f,0.545647f,0.214328f,0.497063f,0.153895f,0.424834f,0.883003f,0.0114936f,0.902812f,0.0313205f,0.533081f,0.301657f,0.353248f,0.0926448f,0.578233f,0.826313f,0.41647f,0.299607f,0.620015f,0.40618f,0.0110304f,0.257348f,0.573268f,0.0621077f,0.23141f,0.245214f,0.616664f,0.633129f,0.652097f,0.240897f,0.0538747f,0.118316f,0.96243f,0.632148f,0.978891f,0.143761f,0.247022f,0.425798f,0.394624f,0.47766f,0.4843f,0.206074f,0.49413f,0.564975f,0.148381f,0.243911f,0.987911f,0.231601f,0.957599f,0.388064f,0.285808f,0.201051f,0.490074f,0.467727f,0.572927f,0.16422f,0.119291f,0.249008f,0.340818f,0.577463f,0.565399f,0.879296f,0.222513f,0.768688f,0.019344f,0.71138f,0.221543f,0.935079f,0.750565f,0.931089f,0.646096f,0.257552f,0.681301f,0.634657f,0.829543f,0.317206f,0.83359f,0.785742f,0.0599354f,0.294875f,0.731582f,0.12975f,0.50774f,0.347406f,0.312918f,0.387898f,0.163543f,0.350749f,0.0706566f,0.402958f,0.0439942f,0.257205f,0.543179f,0.758951f,0.907364f,0.5379f,0.83732f,0.510974f,0.901519f,0.592997f,0.124853f,0.252374f,0.860886f,0.910325f,0.0747687f,0.520687f,0.84519f,0.0802124f,0.62993f,0.0677748f,0.294878f,0.249314f,0.586656f,0.335036f,0.345026f,0.96525f,0.612938f,0.63019f,0.148569f,0.348968f,0.674349f,0.213657f,0.616199f,0.674303f,0.96409f,0.981139f,0.656092f,0.963105f,0.170134f,0.173919f,0.410605f,0.439775f,0.994172f,0.952514f,0.948587f,0.0196173f,0.644344f,0.140724f,0.357299f,0.6314f,0.664236f,0.708748f,0.907964f,0.916963f,0.577239f,0.441691f,0.184609f,0.42311f,0.532011f,0.302541f,0.9432f,0.0560193f,0.262895f,0.241409f,0.145428f,0.316316f,0.764449f,0.107543f,0.773199f,0.508148f,0.00775831f,0.702742f,0.891321f,0.171201f,0.305219f,0.904901f,0.428127f,0.435558f,0.502604f,0.285803f,0.396735f,0.963475f,0.840355f,0.353905f,0.41686f,0.894717f,0.553785f,0.806704f,0.196683f,0.678038f,0.776332f,0.241325f,0.908491f,0.479592f,0.279116f,0.533915f,0.689661f,0.879233f,0.315537f,0.208307f,0.00500109f,0.881549f,0.677103f,0.774383f,0.416695f,0.526238f,0.0831336f,0.13687f,0.666558f,0.0460035f,0.601287f,0.797102f,0.394557f,0.974736f,0.643428f,0.586304f,0.473626f,0.823628f,0.954953f,0.296059f,0.386497f,0.508376f,0.489886f,0.144008f,0.744909f,0.284783f,0.857817f,0.832843f,0.914662f,0.186468f,0.00748893f,0.815519f,0.680362f,0.847246f,0.0720226f,0.860325f,0.789884f,0.82738f,0.971592f,0.167087f,0.175806f,0.465529f,0.265972f,0.326556f,0.68286f,0.639974f,0.818038f,0.455191f,0.168893f,0.19926f,0.704629f,0.29939f,0.60592f,0.632464f,0.932542f,0.997459f,0.693827f,0.922034f,0.547555f,0.872462f,0.768679f,0.158589f,0.889642f,0.788047f,0.205795f,0.606761f,0.464235f,0.335308f,0.469859f,0.384036f,0.365037f,0.509243f,0.719452f,0.456051f,0.932947f,0.273681f,0.859205f,0.271053f,0.0343775f,0.705966f,0.734574f,0.793638f,0.750642f,0.415212f,0.450857f,0.705362f,0.787516f,0.950027f,0.543749f,0.265973f,0.565653f,0.682549f,0.690859f,0.499951f,0.321701f,0.99547f,0.701663f,0.431262f,0.111149f,0.896295f,0.276697f,0.543374f,0.134649f,0.7288f,0.299791f,0.134562f,0.525293f,0.345897f,0.262887f,0.596289f,0.692668f,0.440428f,0.589664f,0.7228f,0.427167f,0.895573f,0.0644652f,0.576086f,0.817547f,0.970838f,0.113292f,0.482636f,0.924655f,0.276034f,0.376611f,0.696f,0.698699f,0.779221f,0.472524f,0.506246f,0.146367f,0.210995f,0.644827f,0.708992f,0.313711f,0.072765f,0.670095f,0.928258f,0.221527f,0.523335f,0.664042f,0.109478f,0.207263f,0.079932f,0.176839f,0.686711f,0.906712f,0.0439875f,0.977414f,0.00705044f,0.998576f,0.827414f,0.11389f,0.354597f,0.656302f,0.534326f,0.79466f,0.838077f,0.762129f,0.223928f,0.867182f,0.853912f,0.517329f,0.573479f,0.292547f,0.17115f,0.958594f,0.759611f,0.695434f,0.453627f,0.982158f,0.754697f,0.716707f,0.524195f,0.646768f,0.171093f,0.454846f,0.347604f,0.189748f,0.579399f,0.166027f,0.900206f,0.892024f,0.367295f,0.228352f,0.115895f,0.295442f,0.447319f,0.910681f,0.721297f,0.484244f,0.520385f,0.762336f,0.189944f,0.688379f,0.843565f,0.684699f,0.73792f,0.377649f,0.727907f,0.000713693f,0.115294f,0.179546f,0.418916f,0.56339f,0.766746f,0.198808f,0.879528f,0.533462f,0.789666f,0.190717f,0.27882f,0.529274f,0.60875f,0.925449f,0.999538f,0.941291f,0.915125f,0.861341f,0.971226f,0.660624f,0.858053f,0.257286f,0.98634f,0.272371f,0.207007f,0.244409f,0.530108f,0.75902f,0.46774f,0.263003f,0.129945f,0.791457f,0.530075f,0.61233f,0.708855f,0.551615f,0.728396f,0.591609f,0.668964f,0.115798f,0.504031f,0.588966f,0.35389f,0.175301f,0.038795f,0.0647323f,0.0821987f,0.523568f,0.902183f,0.234456f,0.389202f,0.953991f,0.353772f,0.162903f,0.939329f,0.714714f,0.793772f,0.677977f,0.348931f,0.160968f,0.666971f,0.272318f,0.611411f,0.811969f,0.424373f,0.836315f,0.714661f,0.307108f,0.669656f,0.506377f,0.225764f,0.0999766f,0.527784f,0.176005f,0.0140051f,0.254351f,0.410044f,0.212395f,0.552615f,0.825598f,0.897967f,0.73811f,0.433818f,0.469532f,0.959268f,0.938359f,0.866672f,0.584202f,0.0580421f,0.479298f,0.581282f,0.942379f,0.163687f,0.339368f,0.0978454f,0.463293f,0.187177f,0.889099f,0.869814f,0.741585f,0.593934f,0.461398f,0.46817f,0.185815f,0.763137f,0.695033f,0.0815168f,0.808364f,0.131995f,0.302333f,0.253878f,0.8783f,0.625264f,0.972665f,0.51435f,0.0920288f,0.689718f,0.110329f,0.861205f,0.254637f,0.725552f,0.214415f,0.081483f,0.702125f,0.456636f,0.94355f,0.104556f,0.373518f,0.236192f,0.885305f,0.423956f,0.433575f,0.787505f,0.204833f,0.585408f,0.712592f,0.0430384f,0.48784f,0.0881832f,0.328901f,0.922197f,0.87015f,0.428452f,0.901498f,0.639949f,0.683178f,0.108318f,0.907537f,0.825947f,0.173591f,0.427554f,0.913982f,0.98431f,0.632093f,0.0172069f,0.8591f,0.218288f,0.194364f,0.614681f,0.804071f,0.771605f,0.980021f,0.714896f,0.924067f,0.749374f,0.689602f,0.838016f,0.538339f,0.2742f,0.516855f,0.977436f,0.900605f,0.126639f,0.784573f,0.526253f,0.0990163f,0.575998f,0.339344f,0.927908f,0.0211111f,0.395668f,0.790059f,0.201836f,0.939652f,0.00808969f,0.919494f,0.0593944f,0.470974f,0.998869f,0.621826f,0.787918f,0.426882f,0.946095f,0.0672336f,0.161124f,0.696783f,0.192896f,0.0395703f,0.0805282f,0.193518f,0.282174f,0.761909f,0.679839f,0.764669f,0.410537f,0.31149f,0.17036f,0.0492137f,0.468382f,0.942446f,0.207613f,0.149208f,0.392895f,0.714652f,0.261003f,0.614429f,0.980819f,0.326889f,0.952999f,0.244492f,0.278271f,0.58536f,0.755384f,0.0407116f,0.442392f,0.674677f,0.132154f,0.597689f,0.0250398f,0.601614f,0.0199593f,0.83372f,0.0155899f,0.377504f,0.530593f,0.792457f,0.928835f,0.384813f,0.0100932f,0.214969f,0.462303f,0.0639783f,0.0872452f,0.0116731f,0.902786f,0.688416f,0.44023f,0.258044f,0.924984f,0.778288f,0.671034f,0.708277f,0.771031f,0.752215f,0.484088f,0.697388f,0.0758607f,0.744497f,0.944957f,0.338986f,0.443782f,0.120114f,0.268719f,0.126621f,0.238591f,0.611809f,0.372969f,0.842732f,0.0548672f,0.396524f,0.725833f,0.684244f,0.983385f,0.766233f,0.620206f,0.414412f,0.410432f,0.604064f,0.96993f,0.0764035f,0.226021f,0.515522f,0.825741f,0.82342f,0.380137f,0.0888949f,0.304793f,0.8932f,0.28183f,0.905898f,0.356197f,0.927997f,0.346685f,0.767012f,0.751379f,0.912739f,0.589238f,0.536779f,0.698589f,0.72528f,0.613594f,0.626452f,0.0146604f,0.477406f,0.323427f,0.106153f,0.777999f,0.265581f,0.658064f,0.714991f,0.121471f,0.898939f,0.658241f,0.206676f,0.128976f,0.208265f,0.955304f,0.772456f,0.70023f,0.0502327f,0.225357f,0.0919609f,0.885891f,0.607491f,0.000462823f,0.445943f,0.472102f,0.312719f,0.243203f,0.601583f,0.330047f,0.587311f,0.117906f,0.390636f,0.12144f,0.852944f,0.0457371f,0.335584f,0.540309f,0.72329f,0.0265907f,0.566799f,0.231772f,0.995137f,0.336858f,0.943392f,0.0333327f,0.677485f,0.924097f,0.868579f,0.11392f,0.631234f,0.679053f,0.309147f,0.890171f,0.276671f,0.987217f,0.21705f,0.437807f,0.473941f,0.898117f,0.77137f,0.336461f,0.961057f,0.324117f,0.864501f,0.970394f,0.486111f,0.876942f,0.0130721f,0.651562f,0.0630578f,0.0526639f,0.779626f,0.911752f,0.715718f,0.299797f,0.299762f,0.740895f,0.620997f,0.552204f,0.325294f,0.367469f,0.705932f,0.512739f,0.125035f,0.486812f,0.321586f,0.609517f,0.123702f,0.640036f,0.508917f,0.115846f,0.802678f,0.101638f,0.812776f,0.816508f,0.409225f,0.35846f,0.452221f,0.120055f,0.473363f,0.899115f,0.103405f,0.74275f,0.576396f,0.269436f,0.0540126f,0.996829f,0.682701f,0.670652f,0.678658f,0.754484f,0.983906f,0.776855f,0.393165f,0.852125f,0.858838f,0.864449f,0.562742f,0.00667925f,0.99562f,0.0566368f,0.633754f,0.601561f,0.801723f,0.376497f,0.481421f,0.153073f,0.840568f,0.773812f,0.364059f,0.491024f,0.779741f,0.958465f,0.215594f,0.797675f,0.946823f,0.655059f,0.258763f,0.376556f,0.205481f,0.151396f,0.877613f,0.982506f,0.506908f,0.0495858f,0.191412f,0.853303f,0.961976f,0.0462063f,0.975305f,0.692913f,0.578614f,0.777377f,0.551982f,0.610155f,0.144673f,0.773517f,0.923062f,0.260347f,0.648044f,0.634663f,0.0126906f,0.858561f,0.126967f,0.325747f,0.187392f,0.827447f,0.0154879f,0.725138f,0.162226f,0.575511f,0.514204f,0.741768f,0.0217911f,0.0239131f,0.123143f,0.997487f,0.289893f,0.71286f,0.222913f,0.330995f,0.370478f,0.433085f,0.118757f,0.672383f,0.955371f,0.141675f,0.377692f,0.909974f,0.55425f,0.911636f,0.683563f,0.396132f,0.678901f,0.278479f,0.156562f,0.563628f,0.901053f,0.299182f,0.956568f,0.630882f,0.739676f,0.77656f,0.530474f,0.564332f,0.966069f,0.450371f,0.976758f,0.204231f,0.270134f,0.15825f,0.873856f,0.0882471f,0.410576f,0.275106f,0.346685f,0.325154f,0.169971f,0.945142f,0.262624f,0.911143f,0.917523f,0.0962264f,0.199994f,0.199085f,0.0601812f,0.542087f,0.779575f,0.668735f,0.711277f,0.951462f,0.743325f,0.657124f,0.523043f,0.385796f,0.895944f,0.963682f,0.979121f,0.859315f,0.741821f,0.375141f,0.307067f,0.294607f,0.247316f,0.41677f,0.0149677f,0.856722f,0.479345f,0.823363f,0.669272f,0.839783f,0.463171f,0.499439f,0.598467f,0.618339f,0.41327f,0.904384f,0.41221f,0.321087f,0.734624f,0.161387f,0.271178f,0.523649f,0.54949f,0.981636f,0.575996f,0.0555991f,0.762012f,0.329759f,0.057602f,0.220281f,0.43538f,0.232487f,0.427403f,0.340611f,0.960258f,0.881764f,0.810433f,0.585328f,0.368245f,0.643449f,0.406264f,0.74102f,0.308166f,0.646687f,0.084892f,0.858417f,0.882379f,0.408191f,0.00159461f,0.0857629f,0.876763f,0.213594f,0.468816f,0.701292f,0.83792f,0.846329f,0.894794f,0.293289f,0.416299f,0.658966f,0.637391f,0.495283f,0.523339f,0.2991f,0.522979f,0.322512f,0.246316f,0.491903f,0.0746255f,7.8445e-005f,0.904303f,0.879546f,0.778357f,0.517641f,0.969689f,0.460999f,0.936057f,0.578991f,0.0354415f,0.00532479f,0.202428f,0.0104537f,0.770735f,0.660301f,0.385332f,0.404694f,0.661421f,0.7097f,0.309723f,0.992693f,0.781668f,0.318379f,0.544805f,0.517141f,0.726662f,0.67657f,0.267566f,0.950086f,0.952819f,0.956471f,0.751015f,0.156489f,0.885997f,0.590631f,0.0632626f,0.899082f,0.891345f,0.659022f,0.367189f,0.719526f,0.878464f,0.359802f,0.130536f,0.556574f,0.869422f,0.33031f,0.414376f,0.030861f,0.136063f,0.621262f,0.501234f,0.49064f,0.870095f,0.0731028f,0.629756f,0.0365925f,0.606673f,0.948068f,0.314643f,0.739759f,0.45731f,0.950961f,0.962672f,0.654756f,0.0389264f,0.555516f,0.579928f,0.448517f,0.275711f,0.686901f,0.778688f,0.518072f,0.0171811f,0.344254f,0.771869f,0.77615f,0.118125f,0.240585f,0.326728f,0.783184f,0.253697f,0.0730975f,0.541266f,0.678179f,0.0704757f,0.245243f,0.223762f,0.236493f,0.263924f,0.487212f,0.639068f,0.91728f,0.605327f,0.388939f,0.0786105f,0.437684f,0.258478f,0.81304f,0.617214f,0.0768097f,0.657798f,0.942781f,0.0959515f,0.616325f,0.344049f,0.84558f,0.330967f,0.0694835f,0.288256f,0.0308165f,0.896685f,0.930698f,0.841653f,0.665053f,0.98484f,0.325124f,0.757799f,0.174019f,0.809325f,0.910923f,0.792643f,0.632893f,0.272109f,0.826541f,0.215005f,0.0165364f,0.814703f,0.372545f,0.146577f,0.0860875f,0.192506f,0.247148f,0.0650242f,0.93575f,0.181761f,0.231522f,0.15142f,0.383365f,0.707312f,0.699399f,0.875437f,0.0813269f,0.56264f,0.308567f,0.922863f,0.721123f,0.526879f,0.41858f,0.152833f,0.663525f,0.443309f,0.467035f,0.883577f,0.204677f,0.87964f,0.168993f,0.54993f,0.940419f,0.665712f,0.247042f,0.962565f,0.780286f,0.110413f,0.316274f,0.273545f,0.482773f,0.802011f,0.53423f,0.560353f,0.916273f,0.134851f,0.348981f,0.939362f,0.0449581f,0.915296f,0.0461536f,0.386969f,0.844952f,0.395561f,0.978895f,0.253651f,0.204729f,0.0593258f,0.326486f,0.284155f,0.855363f,0.518923f,0.386347f,0.988503f,0.556458f,0.135657f,0.871753f,0.193246f,0.174518f,0.349553f,0.518479f,0.99108f,0.439921f,0.336654f,0.424953f,0.692152f,0.0397344f,0.0732937f,0.255473f,0.189967f,0.560782f,0.964629f,0.311403f,0.371387f,0.469203f,0.801392f,0.15174f,0.00626313f,0.270118f,0.543772f,0.743497f,0.493016f,0.746908f,0.803444f,0.0913807f,0.222933f,0.715084f,0.0455235f,0.976007f,0.767568f,0.0694174f,0.276716f,0.19466f,0.372959f,0.786124f,0.766327f,0.500709f,0.300888f,0.199716f,0.855008f,0.239178f,0.469019f,0.399236f,0.232465f,0.16686f,0.916217f,0.973134f,0.568881f,0.827991f,0.782635f,0.456563f,0.974849f,0.554959f,0.603817f,0.373116f,0.589029f,0.841039f,0.658897f,0.399772f,0.909529f,0.496831f,0.383197f,0.570037f,0.630989f,0.530361f,0.405723f,0.563421f,0.304477f,0.121384f,0.495061f,0.368394f,0.441135f,0.2561f,0.784467f,0.00233745f,0.139338f,0.823668f,0.0737295f,0.904712f,0.305897f,0.489576f,0.209418f,0.693599f,0.584805f,0.746791f,0.0616489f,0.336319f,0.527198f,0.498556f,0.435797f,0.0928095f,0.711529f,0.0387021f,0.663306f,0.395635f,0.74644f,0.135885f,0.955952f,0.130559f,0.401306f,0.543889f,0.494105f,0.669044f,0.165496f,0.654862f,0.706325f,0.606464f,0.127183f,0.00191501f,0.726295f,0.283804f,0.601815f,0.936416f,0.781362f,0.0571171f,0.887758f,0.984572f,0.560351f,0.0290583f,0.238925f,0.495611f,0.935334f,0.740145f,0.52368f,0.190798f,0.928253f,0.536712f,0.940612f,0.446011f,0.560453f,0.835647f,0.240708f,0.865762f,0.648615f,0.930527f,0.91781f,0.261324f,0.495436f,0.671955f,0.695916f,0.987204f,0.818232f,0.179836f,0.917276f,0.536846f,0.745422f,0.297516f,0.26617f,0.57758f,0.899882f,0.103532f,0.83507f,0.847112f,0.24138f,0.38546f,0.141282f,0.0320046f,0.720321f,0.129129f,0.575835f,0.637505f,0.106764f,0.33331f,0.406446f,0.258762f,0.345742f,0.714676f,0.837746f,0.305257f,0.91595f,0.551054f,0.65665f,0.341483f,0.514251f,0.0818331f,0.927384f,0.947537f,0.418518f,0.0743022f,0.719434f,0.245735f,0.0963175f,0.440125f,0.799607f,0.883696f,0.488243f,0.27147f,0.99163f,0.657822f,0.556332f,0.724213f,0.25145f,0.547377f,0.323633f,0.892885f,0.946246f,0.891211f,0.578664f,0.381954f,0.300313f,0.0891369f,0.807738f,0.165852f,0.408828f,0.535743f,0.363909f,0.866593f,0.394415f,0.8576f,0.413634f,0.471214f,0.818354f,0.962698f,0.314679f,0.965744f,0.950689f,0.542311f,0.865113f,0.675904f,0.364284f,0.399935f,0.965076f,0.633419f,0.807675f,0.791961f,0.0638251f,0.16986f,0.602568f,0.790007f,0.497242f,0.237209f,0.957598f,0.100894f,0.874651f,0.662847f,0.0249065f,0.266422f,0.509838f,0.418802f,0.715867f,0.335732f,0.788464f,0.407303f,0.491483f,0.61304f,0.981859f,0.0228451f,0.739285f,0.796928f,0.765217f,0.901448f,0.154142f,0.367801f,0.660486f,0.71289f,0.28317f,0.209092f,0.727144f,0.116454f,0.765822f,0.315317f,0.328435f,0.539086f,0.931063f,0.974448f,0.222229f,0.653351f,0.524463f,0.466601f,0.425759f,0.645213f,0.00384574f,0.323541f,0.352734f,0.929033f,0.754713f,0.861587f,0.772162f,0.924614f,0.399458f,0.869766f,0.276495f,0.816722f,0.948672f,0.671535f,0.397998f,0.473555f,0.348371f,0.489812f,0.154705f,0.0956349f,0.87262f,0.718657f,0.275185f,0.644228f,0.462317f,0.41859f,0.443406f,0.279774f,0.0109839f,0.853293f,0.383774f,0.43998f,0.0566688f,0.953749f,0.918813f,0.224911f,0.528944f,0.584639f,0.572144f,0.524427f,0.353038f,0.803346f,0.513382f,0.929365f,0.560225f,0.748667f,0.623791f,0.372897f,0.0871715f,0.383623f,0.229881f,0.246359f,0.0773045f,0.439438f,0.923037f,0.7212f,0.567159f,0.290863f,0.384726f,0.331207f,0.484783f,0.610876f,0.0219879f,0.846834f,0.441678f,0.409397f,0.643356f,0.442426f,0.796379f,0.970346f,0.765176f,0.743199f,0.85982f,0.0291272f,0.870319f,0.433137f,0.900894f,0.106739f,0.593588f,0.304344f,0.637198f,0.808159f,0.742273f,0.923045f,0.192572f,0.771675f,0.320499f,0.220393f,0.322671f,0.0848894f,0.203521f,0.0102857f,0.422723f,0.906651f,0.403297f,0.982788f,0.667101f,0.198767f,0.785043f,0.96548f,0.265053f,0.489191f,0.602004f,0.118682f,0.21581f,0.248936f,0.803059f,0.228406f,0.694657f,0.261616f,0.973546f,0.259526f,0.717017f,0.217286f,0.898507f,0.531694f,0.23164f,0.719053f,0.661841f,0.913046f,0.884217f,0.138001f,0.70729f,0.669928f,0.445826f,0.590217f,0.566312f,0.730487f,0.817962f,0.115635f,0.89675f,0.861756f,0.798587f,0.203239f,0.929635f,0.709423f,0.016198f,0.740575f,0.535218f,0.69317f,0.963725f,0.780653f,0.121621f,0.413643f,0.626379f,0.153731f,0.97754f,0.229516f,0.660571f,0.0464624f,0.757329f,0.411868f,0.0611639f,0.623976f,0.954925f,0.552082f,0.959547f,0.385958f,0.659902f,0.337551f,0.72417f,0.650366f,0.921758f,0.475333f,0.217428f,0.0363314f,0.878906f,0.236808f,0.078046f,0.192366f,0.423525f,0.564184f,0.470329f,0.847225f,0.611151f,0.536519f,0.191473f,0.244716f,0.199764f,0.210875f,0.829096f,0.880414f,0.90384f,0.0590107f,0.21475f,0.902226f,0.193171f,0.772757f,0.670937f,0.46655f,0.840292f,0.968085f,0.274474f,0.842532f,0.465214f,0.594342f,0.89859f,0.610604f,0.930866f,0.461411f,0.740833f,0.902791f,0.238285f,0.700362f,0.448502f,0.792169f,0.39635f,0.306796f,0.493692f,0.755366f,0.678184f,0.485146f,0.843155f,0.499176f,0.27599f,0.179709f,0.83422f,0.018321f,0.419587f,0.861302f,0.385558f,0.462705f,0.651661f,0.488553f,0.24754f,0.807063f,0.561992f,0.320509f,0.354583f,0.564898f,0.515973f,0.500998f,0.94172f,0.105932f,0.140322f,0.151333f,0.402741f,0.398895f,0.820341f,0.890911f,0.061314f,0.879306f,0.350156f,0.500185f,0.4508f,0.875809f,0.243896f,0.610312f,0.810436f,0.98457f,0.105982f,0.696425f,0.24676f,0.558765f,0.634392f,0.420541f,0.671956f,0.431087f,0.843182f,0.483225f,0.598779f,0.796217f,0.614997f,0.171959f,0.582416f,0.332045f,0.171262f,0.277424f,0.124886f,0.589969f,0.527426f,0.607403f,0.0592987f,0.336458f,0.12011f,0.201759f,0.201452f,0.164375f,0.905426f,0.0490471f,0.283515f,0.928881f,0.91195f,0.169419f,0.803325f,0.80263f,0.981445f,0.465364f,0.632779f,0.151134f,0.630822f,0.103398f,0.0254437f,0.940896f,0.346818f,0.0986557f,0.923509f,0.748267f,0.958398f,0.242726f,0.23841f,0.0838539f,0.33556f,0.851027f,0.749221f,0.645384f,0.337608f,0.532414f,0.892086f,0.286268f,0.536324f,0.297366f,0.28884f,0.435107f,0.135309f,0.46432f,0.97627f,0.37104f,0.185826f,0.508475f,0.208028f,0.0780732f,0.784221f,0.79722f,0.388445f,0.495982f,0.675447f,0.213059f,0.754742f,0.870486f,0.205806f,0.969568f,0.134453f,0.556191f,0.780812f,0.920867f,0.0470477f,0.874899f,0.469395f,0.641365f,0.125295f,0.991631f,0.877727f,0.290063f,0.510416f,0.836726f,0.0134675f,0.528281f,0.542372f,0.0349166f,0.893473f,0.378395f,0.514739f,0.699472f,0.951674f,0.883303f,0.80935f,0.464443f,0.0438049f,0.363421f,0.227028f,0.130145f,0.0100327f,0.329677f,0.0383763f,0.290237f,0.604287f,0.878311f,0.0472817f,0.740482f,0.501433f,0.697189f,0.714562f,0.176482f,0.271253f,0.322067f,0.0166131f,0.627085f,0.76129f,0.626636f,0.133879f,0.848167f,0.959807f,0.96773f,0.236835f,0.16953f,0.0602073f,0.173017f,0.633949f,0.551262f,0.209558f,0.93738f,0.616295f,0.0182512f,0.143415f,0.844934f,0.617452f,0.492005f,0.437553f,0.534461f,0.941079f,0.283974f,0.622426f,0.564133f,0.740807f,0.786428f,0.324597f,0.661679f,0.528713f,0.715158f,0.782448f,0.829301f,0.375625f,0.179818f,0.729873f,0.0894799f,0.475436f,0.295332f,0.479144f,0.742509f,0.846809f,0.308548f,0.0181656f,0.899089f,0.595207f,0.500896f,0.755547f,0.582197f,0.00892669f,0.590772f,0.79614f,0.636272f,0.0865137f,0.000400858f,0.577904f,0.300942f,0.357874f,0.122029f,0.378619f,0.166174f,0.681148f,0.0161585f,0.404783f,0.520175f,0.591442f,0.659904f,0.964519f,0.548123f,0.214151f,0.0457445f,0.264102f,0.160863f,0.00167315f,0.086267f,0.992296f,0.51083f,0.114924f,0.124341f,0.856497f,0.922631f,0.22585f,0.583768f,0.092772f,0.625299f,0.637149f,0.72043f,0.84873f,0.910084f,0.0808401f,0.87427f,0.431572f,0.826047f,0.759342f,0.873891f,0.470554f,0.82748f,0.715528f,0.438139f,0.797233f,0.601063f,0.00423314f,0.799127f,0.680482f,0.953272f,0.362146f,0.00586606f,0.526145f,0.462703f,0.433653f,0.16268f,0.728373f,0.671521f,0.330962f,0.0871261f,0.804806f,0.684331f,0.677947f,0.691644f,0.809157f,0.906235f,0.455602f,0.641041f,0.138676f,0.759259f,0.052318f,0.7004f,0.155272f,0.527253f,0.959527f,0.962787f,0.0575192f,0.26707f,0.306542f,0.018849f,0.540003f,0.953501f,0.646708f,0.680009f,0.326098f,0.258661f,0.631946f,0.00577f,0.435564f,0.76403f,0.842939f,0.192828f,0.979325f,0.191665f,0.0879078f,0.377166f,0.344783f,0.259401f,0.497762f,0.995773f,0.58316f,0.741265f,0.981677f,0.177416f,0.329115f,0.793979f,0.0705367f,0.680194f,0.688137f,0.333306f,0.680309f,0.347924f,0.319998f,0.842462f,0.890384f,0.763341f,0.876062f,0.529042f,0.651628f,0.645724f,0.595985f,0.479623f,0.130402f,0.0193731f,0.768802f,0.429958f,0.702744f,0.148294f,0.169341f,0.148534f,0.504204f,0.250727f,0.6189f,0.445693f,0.491261f,0.325889f,0.406374f,0.841954f,0.614259f,0.815679f,0.378636f,0.477352f,0.95838f,0.303468f,0.836013f,0.359254f,0.787635f,0.724289f,0.0889057f,0.999074f,0.873233f,0.595166f,0.603398f,0.586113f,0.918738f,0.294356f,0.790441f,0.641907f,0.483123f,0.763519f,0.717748f,0.120373f,0.474139f,0.431704f,0.158093f,0.710889f,0.764159f,0.0107394f,0.17815f,0.879489f,0.905709f,0.00914567f,0.382773f,0.424317f,0.946208f,0.458462f,0.934147f,0.360029f,0.0908572f,0.0748174f,0.55021f,0.905336f,0.528543f,0.317171f,0.539526f,0.0056937f,0.578706f,0.401794f,0.356387f,0.238194f,0.568962f,0.504652f,0.524591f,0.659351f,0.539575f,0.193907f,0.0501228f,0.103211f,0.861701f,0.0928236f,0.118399f,0.960386f,0.464065f,0.462186f,0.223749f,0.783675f,0.41981f,0.997503f,0.205461f,0.314207f,0.343356f,0.459535f,0.0698174f,0.980991f,0.671963f,0.668571f,0.0595499f,0.242049f,0.640997f,0.622202f,0.202451f,0.585023f,0.116969f,0.274842f,0.561636f,0.498952f,0.562897f,0.965908f,0.259299f,0.761942f,0.156429f,0.575014f,0.274453f,0.422674f,0.532318f,0.13675f,0.809351f,0.0507262f,0.837969f,0.758922f,0.33732f,0.833217f,0.380397f,0.79624f,0.249372f,0.509206f,0.967494f,0.874991f,0.933832f,0.974842f,0.198491f,0.511616f,0.0773459f,0.0394034f,0.617254f,0.165966f,0.262446f,0.848435f,0.0883463f,0.773933f,0.198017f,0.396429f,0.11225f,0.216011f,0.12153f,0.783211f,0.539996f,0.977417f,0.548293f,0.441791f,0.685907f,0.364944f,0.459616f,0.702906f,0.189505f,0.655996f,0.0880187f,0.405877f,0.0983226f,0.843005f,0.454448f,0.636149f,0.452542f,0.569996f,0.537f,0.679384f,0.874904f,0.392433f,0.688863f,0.148975f,0.50114f,0.864462f,0.654969f,0.0847118f,0.96589f,0.450241f,0.140698f,0.146521f,0.398976f,0.185366f,0.825774f,0.0405722f,0.175783f,0.476493f,0.661003f,0.932548f,0.784114f,0.554015f,0.460409f,0.668652f,0.294312f,0.65338f,0.34617f,0.42172f,0.801059f,0.964518f,0.266547f,0.139621f,0.455713f,0.999931f,0.135437f,0.151911f,0.570752f,0.979861f,0.0875793f,0.234683f,0.492545f,0.924679f,0.362731f,0.804425f,0.685403f,0.435503f,0.187826f,0.246328f,0.107991f,0.196117f,0.419881f,0.901014f,0.636307f,0.886187f,0.761935f,0.185654f,0.20067f,0.570181f,0.107333f,0.716814f,0.101034f,0.0105145f,0.100285f,0.626739f,0.234296f,0.440237f,0.717189f,0.96987f,0.319504f,0.27466f,0.1796f,0.705884f,0.642369f,0.879529f,0.602136f,0.586218f,0.899861f,0.223626f,0.00162988f,0.703812f,0.524971f,0.599654f,0.583424f,0.537509f,0.649929f,0.886754f,0.0251348f,0.990828f,0.9492f,0.0717774f,0.130551f,0.946622f,0.352109f,0.907082f,0.0815199f,0.20278f,0.338609f,0.773468f,0.157793f,0.814205f,0.24474f,0.180947f,0.380239f,0.575415f,0.38419f,0.641465f,0.164639f,0.328534f,0.996143f,0.72114f,0.923903f,0.75851f,0.521649f,0.230333f,0.946098f,0.706686f,0.208905f,0.958686f,0.42084f,0.730659f,0.237007f,0.88613f,0.309582f,0.332105f,0.678688f,0.0263163f,0.544233f,0.586047f,0.995924f,0.0979156f,0.724884f,0.755969f,0.302062f,0.413996f,0.515113f,0.522249f,0.230344f,0.786732f,0.0744869f,0.117197f,0.5627f,0.306073f,0.894952f,0.269944f,0.917451f,0.0393496f,0.732564f,0.349196f,0.763229f,0.171622f,0.711653f,0.210948f,0.855722f,0.404091f,0.381293f,0.299304f,0.66514f,0.377637f,0.352407f,0.581496f,0.387328f,0.394303f,0.0976539f,0.60196f,0.292504f,0.204022f,0.184426f,0.919543f,0.841935f,0.982006f,0.738204f,0.100333f,0.233818f,0.398588f,0.569684f,0.242966f,0.0231002f,0.930467f,0.0958806f,0.981614f,0.199327f,0.19193f,0.83418f,0.46452f,0.611246f,0.78421f,0.705848f,0.787105f,0.950402f,0.381167f,0.148465f,0.627151f,0.0483577f,0.0171834f,0.647508f,0.696912f,0.300081f,0.0129141f,0.619884f,0.934829f,0.499489f,0.63633f,0.605274f,0.513395f,0.377452f,0.820883f,0.0720689f,0.948211f,0.0158378f,0.326114f,0.442176f,0.867679f,0.458628f,0.02637f,0.0384894f,0.749154f,0.70228f,0.616308f,0.569735f,0.523683f,0.682185f,0.410394f,0.653597f,0.811993f,0.380898f,0.273919f,0.329399f,0.381108f,0.216364f,0.610808f,0.85663f,0.0579701f,0.092253f,0.251526f,0.0442808f,0.835742f,0.843404f,0.977972f,0.390873f,0.039428f,0.138996f,0.761555f,0.247493f,0.0402716f,0.466832f,0.897306f,0.52393f,0.7824f,0.342573f,0.274865f,0.914161f,0.754331f,0.588159f,0.365527f,0.825172f,0.826902f,0.711998f,0.65461f,0.434923f,0.614749f,0.072054f,0.269705f,0.109299f,0.875851f,0.899521f,0.00300577f,0.901822f,0.877101f,0.979921f,0.994199f,0.321955f,0.180382f,0.147204f,0.672304f,0.287426f,0.321083f,0.510224f,0.346136f,0.770496f,0.869235f,0.840596f,0.0502891f,0.968293f,0.791344f,0.322162f,0.399061f,0.590243f,0.143087f,0.200315f,0.125404f,0.162113f,0.552793f,0.966754f,0.361113f,0.688789f,0.898306f,0.602262f,0.617228f,0.58926f,0.527837f,0.482833f,0.837079f,0.505726f};
*/

#include "noiseTables.h"

// Helper gradient functions
template <class T>	T  grad(int hash,T x) {
    int h		= hash & 15;
    T	grad	= (T) 1.0 + (h & 7);
    if (h&8) grad = -grad;
    return ( grad * x );
}

template <class T>	T  grad(int hash,T x,T y) {
    int		h = hash & 7;
    const T	u = h<4 ? x : y;
    const T	v = h<4 ? y : x;
    return ((h&1)? -u : u) + ((h&2)? (T) -2.0*v : (T) 2.0*v);
}

template <class T>	T  grad(int hash,T x,T y ,T z) {
    int		h = hash & 15;
    const T	u = h<8 ? x : y;
    const T	v = h<4 ? y : h==12||h==14 ? x : z;
    return ((h&1)? -u : u) + ((h&2)? -v : v);
}

template <class T>	T  grad(int hash,T x,T y,T z,T t ) {
    int		h = hash & 31;
    const T	u = h<24 ? x : y;
    const T	v = h<16 ? y : z;
    const T	w = h<8 ? z : t;
    return ((h&1)? -u : u) + ((h&2)? -v : v) + ((h&4)? -w : w);
}




/////////////////////////////////////////////////////////////////////////////////
//
//	Noise functions start here
//
/////////////////////////////////////////////////////////////////////////////////




template <class T>	T  noise(T x,const unsigned char *perm) {
    int ix0, ix1;
    T	fx0, fx1;
    T	s, n0, n1;

    ix0 = FASTFLOOR( x );
    fx0 = x - ix0;
    fx1 = fx0 - 1.0f;
    ix1 = ( ix0+1 ) & 0xff;
    ix0 = ix0 & 0xff;

    s	= FADE( fx0 );

    n0	= grad( perm[ ix0 ], fx0 );
    n1	= grad( perm[ ix1 ], fx1 );
    return 0.5f * (1.0f + 0.188f * ( LERP( s, n0, n1 ) ));
}

template <class T>	T	pnoise(T x,int px,const unsigned char *perm) {
    int ix0, ix1;
    T	fx0, fx1;
    T	s, n0, n1;

    ix0 = FASTFLOOR( x );
    fx0 = x - ix0;
    fx1 = fx0 - 1.0f;
    ix1 = (( ix0 + 1 ) % px) & 0xff;
    ix0 = ( ix0 % px ) & 0xff;

    s = FADE( fx0 );

    n0 = grad( perm[ ix0 ], fx0 );
    n1 = grad( perm[ ix1 ], fx1 );
    return 0.5f * (1.0f + 0.188f * ( LERP( s, n0, n1 ) ));
}


template <class T>	T  noise(T x,T y,const unsigned char *perm) {
    int ix0, iy0, ix1, iy1;
    T	fx0, fy0, fx1, fy1;
    T	s, t, nx0, nx1, n0, n1;

    ix0 = FASTFLOOR( x );
    iy0 = FASTFLOOR( y );
    fx0 = x - ix0;
    fy0 = y - iy0;
    fx1 = fx0 - 1.0f;
    fy1 = fy0 - 1.0f;
    ix1 = (ix0 + 1) & 0xff;
    iy1 = (iy0 + 1) & 0xff;
    ix0 = ix0 & 0xff;
    iy0 = iy0 & 0xff;
    
    t = FADE( fy0 );
    s = FADE( fx0 );

    nx0 = grad(perm[ix0 + perm[iy0]], fx0, fy0);
    nx1 = grad(perm[ix0 + perm[iy1]], fx0, fy1);
    n0 = LERP( t, nx0, nx1 );

    nx0 = grad(perm[ix1 + perm[iy0]], fx1, fy0);
    nx1 = grad(perm[ix1 + perm[iy1]], fx1, fy1);
    n1 = LERP(t, nx0, nx1);

    return 0.5f * (1.0f + 0.507f * ( LERP( s, n0, n1 ) ) );
}

template <class T>	T  pnoise(T x,T y, int px, int py,const unsigned char *perm) {
    int ix0, iy0, ix1, iy1;
    T	fx0, fy0, fx1, fy1;
    T	s, t, nx0, nx1, n0, n1;

    ix0 = FASTFLOOR( x );
    iy0 = FASTFLOOR( y );
    fx0 = x - ix0;
    fy0 = y - iy0;
    fx1 = fx0 - 1.0f;
    fy1 = fy0 - 1.0f;
    ix1 = (( ix0 + 1 ) % px) & 0xff;
    iy1 = (( iy0 + 1 ) % py) & 0xff;
    ix0 = ( ix0 % px ) & 0xff;
    iy0 = ( iy0 % py ) & 0xff;
    
    t = FADE( fy0 );
    s = FADE( fx0 );

    nx0 = grad(perm[ix0 + perm[iy0]], fx0, fy0);
    nx1 = grad(perm[ix0 + perm[iy1]], fx0, fy1);
    n0 = LERP( t, nx0, nx1 );

    nx0 = grad(perm[ix1 + perm[iy0]], fx1, fy0);
    nx1 = grad(perm[ix1 + perm[iy1]], fx1, fy1);
    n1 = LERP(t, nx0, nx1);

    return 0.5f * (1.0f + 0.507f * ( LERP( s, n0, n1 ) ) );
}


template <class T>	T  noise(T x,T y,T z,const unsigned char *perm) {
    int ix0, iy0, ix1, iy1, iz0, iz1;
    T	fx0, fy0, fz0, fx1, fy1, fz1;
    T	s, t, r;
    T	nxy0, nxy1, nx0, nx1, n0, n1;

    ix0 = FASTFLOOR( x );
    iy0 = FASTFLOOR( y );
    iz0 = FASTFLOOR( z );
    fx0 = x - ix0;
    fy0 = y - iy0;
    fz0 = z - iz0;
    fx1 = fx0 - 1.0f;
    fy1 = fy0 - 1.0f;
    fz1 = fz0 - 1.0f;
    ix1 = ( ix0 + 1 ) & 0xff;
    iy1 = ( iy0 + 1 ) & 0xff;
    iz1 = ( iz0 + 1 ) & 0xff;
    ix0 = ix0 & 0xff;
    iy0 = iy0 & 0xff;
    iz0 = iz0 & 0xff;
    
    r = FADE( fz0 );
    t = FADE( fy0 );
    s = FADE( fx0 );

    nxy0 = grad(perm[ix0 + perm[iy0 + perm[iz0]]], fx0, fy0, fz0);
    nxy1 = grad(perm[ix0 + perm[iy0 + perm[iz1]]], fx0, fy0, fz1);
    nx0 = LERP( r, nxy0, nxy1 );

    nxy0 = grad(perm[ix0 + perm[iy1 + perm[iz0]]], fx0, fy1, fz0);
    nxy1 = grad(perm[ix0 + perm[iy1 + perm[iz1]]], fx0, fy1, fz1);
    nx1 = LERP( r, nxy0, nxy1 );

    n0 = LERP( t, nx0, nx1 );

    nxy0 = grad(perm[ix1 + perm[iy0 + perm[iz0]]], fx1, fy0, fz0);
    nxy1 = grad(perm[ix1 + perm[iy0 + perm[iz1]]], fx1, fy0, fz1);
    nx0 = LERP( r, nxy0, nxy1 );

    nxy0 = grad(perm[ix1 + perm[iy1 + perm[iz0]]], fx1, fy1, fz0);
    nxy1 = grad(perm[ix1 + perm[iy1 + perm[iz1]]], fx1, fy1, fz1);
    nx1 = LERP( r, nxy0, nxy1 );

    n1 = LERP( t, nx0, nx1 );
    
    return 0.5f * (1.0f + 0.936f * ( LERP( s, n0, n1 ) ) );
}

template <class T>	T   pnoise(T x,T y,T z,int px,int py,int pz,const unsigned char *perm) {
    int ix0, iy0, ix1, iy1, iz0, iz1;
    T fx0, fy0, fz0, fx1, fy1, fz1;
    T s, t, r;
    T nxy0, nxy1, nx0, nx1, n0, n1;

    ix0 = FASTFLOOR( x );
    iy0 = FASTFLOOR( y );
    iz0 = FASTFLOOR( z );
    fx0 = x - ix0;
    fy0 = y - iy0;
    fz0 = z - iz0;
    fx1 = fx0 - 1.0f;
    fy1 = fy0 - 1.0f;
    fz1 = fz0 - 1.0f;
    ix1 = (( ix0 + 1 ) % px ) & 0xff;
    iy1 = (( iy0 + 1 ) % py ) & 0xff;
    iz1 = (( iz0 + 1 ) % pz ) & 0xff;
    ix0 = ( ix0 % px ) & 0xff;
    iy0 = ( iy0 % py ) & 0xff;
    iz0 = ( iz0 % pz ) & 0xff;
    
    r = FADE( fz0 );
    t = FADE( fy0 );
    s = FADE( fx0 );

    nxy0 = grad(perm[ix0 + perm[iy0 + perm[iz0]]], fx0, fy0, fz0);
    nxy1 = grad(perm[ix0 + perm[iy0 + perm[iz1]]], fx0, fy0, fz1);
    nx0 = LERP( r, nxy0, nxy1 );

    nxy0 = grad(perm[ix0 + perm[iy1 + perm[iz0]]], fx0, fy1, fz0);
    nxy1 = grad(perm[ix0 + perm[iy1 + perm[iz1]]], fx0, fy1, fz1);
    nx1 = LERP( r, nxy0, nxy1 );

    n0 = LERP( t, nx0, nx1 );

    nxy0 = grad(perm[ix1 + perm[iy0 + perm[iz0]]], fx1, fy0, fz0);
    nxy1 = grad(perm[ix1 + perm[iy0 + perm[iz1]]], fx1, fy0, fz1);
    nx0 = LERP( r, nxy0, nxy1 );

    nxy0 = grad(perm[ix1 + perm[iy1 + perm[iz0]]], fx1, fy1, fz0);
    nxy1 = grad(perm[ix1 + perm[iy1 + perm[iz1]]], fx1, fy1, fz1);
    nx1 = LERP( r, nxy0, nxy1 );

    n1 = LERP( t, nx0, nx1 );
    
    return 0.5f * (1.0f + 0.936f * ( LERP( s, n0, n1 ) ) );
}


template <class T>	T  noise(T x,T y,T z,T w,const unsigned char *perm) {
    int ix0, iy0, iz0, iw0, ix1, iy1, iz1, iw1;
    T fx0, fy0, fz0, fw0, fx1, fy1, fz1, fw1;
    T s, t, r, q;
    T nxyz0, nxyz1, nxy0, nxy1, nx0, nx1, n0, n1;

    ix0 = FASTFLOOR( x );
    iy0 = FASTFLOOR( y );
    iz0 = FASTFLOOR( z );
    iw0 = FASTFLOOR( w );
    fx0 = x - ix0;
    fy0 = y - iy0;
    fz0 = z - iz0;
    fw0 = w - iw0;
    fx1 = fx0 - 1.0f;
    fy1 = fy0 - 1.0f;
    fz1 = fz0 - 1.0f;
    fw1 = fw0 - 1.0f;
    ix1 = ( ix0 + 1 ) & 0xff;
    iy1 = ( iy0 + 1 ) & 0xff;
    iz1 = ( iz0 + 1 ) & 0xff;
    iw1 = ( iw0 + 1 ) & 0xff;
    ix0 = ix0 & 0xff;
    iy0 = iy0 & 0xff;
    iz0 = iz0 & 0xff;
    iw0 = iw0 & 0xff;

    q = FADE( fw0 );
    r = FADE( fz0 );
    t = FADE( fy0 );
    s = FADE( fx0 );

    nxyz0 = grad(perm[ix0 + perm[iy0 + perm[iz0 + perm[iw0]]]], fx0, fy0, fz0, fw0);
    nxyz1 = grad(perm[ix0 + perm[iy0 + perm[iz0 + perm[iw1]]]], fx0, fy0, fz0, fw1);
    nxy0 = LERP( q, nxyz0, nxyz1 );
        
    nxyz0 = grad(perm[ix0 + perm[iy0 + perm[iz1 + perm[iw0]]]], fx0, fy0, fz1, fw0);
    nxyz1 = grad(perm[ix0 + perm[iy0 + perm[iz1 + perm[iw1]]]], fx0, fy0, fz1, fw1);
    nxy1 = LERP( q, nxyz0, nxyz1 );
        
    nx0 = LERP ( r, nxy0, nxy1 );

    nxyz0 = grad(perm[ix0 + perm[iy1 + perm[iz0 + perm[iw0]]]], fx0, fy1, fz0, fw0);
    nxyz1 = grad(perm[ix0 + perm[iy1 + perm[iz0 + perm[iw1]]]], fx0, fy1, fz0, fw1);
    nxy0 = LERP( q, nxyz0, nxyz1 );
        
    nxyz0 = grad(perm[ix0 + perm[iy1 + perm[iz1 + perm[iw0]]]], fx0, fy1, fz1, fw0);
    nxyz1 = grad(perm[ix0 + perm[iy1 + perm[iz1 + perm[iw1]]]], fx0, fy1, fz1, fw1);
    nxy1 = LERP( q, nxyz0, nxyz1 );

    nx1 = LERP ( r, nxy0, nxy1 );

    n0 = LERP( t, nx0, nx1 );

    nxyz0 = grad(perm[ix1 + perm[iy0 + perm[iz0 + perm[iw0]]]], fx1, fy0, fz0, fw0);
    nxyz1 = grad(perm[ix1 + perm[iy0 + perm[iz0 + perm[iw1]]]], fx1, fy0, fz0, fw1);
    nxy0 = LERP( q, nxyz0, nxyz1 );
        
    nxyz0 = grad(perm[ix1 + perm[iy0 + perm[iz1 + perm[iw0]]]], fx1, fy0, fz1, fw0);
    nxyz1 = grad(perm[ix1 + perm[iy0 + perm[iz1 + perm[iw1]]]], fx1, fy0, fz1, fw1);
    nxy1 = LERP( q, nxyz0, nxyz1 );

    nx0 = LERP ( r, nxy0, nxy1 );

    nxyz0 = grad(perm[ix1 + perm[iy1 + perm[iz0 + perm[iw0]]]], fx1, fy1, fz0, fw0);
    nxyz1 = grad(perm[ix1 + perm[iy1 + perm[iz0 + perm[iw1]]]], fx1, fy1, fz0, fw1);
    nxy0 = LERP( q, nxyz0, nxyz1 );
        
    nxyz0 = grad(perm[ix1 + perm[iy1 + perm[iz1 + perm[iw0]]]], fx1, fy1, fz1, fw0);
    nxyz1 = grad(perm[ix1 + perm[iy1 + perm[iz1 + perm[iw1]]]], fx1, fy1, fz1, fw1);
    nxy1 = LERP( q, nxyz0, nxyz1 );

    nx1 = LERP ( r, nxy0, nxy1 );

    n1 = LERP( t, nx0, nx1 );

    return 0.5f * (1.0f + 0.87f * ( LERP( s, n0, n1 ) ) );
}

template <class T>	T  pnoise(T x,T y,T z, float w,int px,int py,int pz,int pw,const unsigned char *perm) {
    int ix0, iy0, iz0, iw0, ix1, iy1, iz1, iw1;
    T fx0, fy0, fz0, fw0, fx1, fy1, fz1, fw1;
    T s, t, r, q;
    T nxyz0, nxyz1, nxy0, nxy1, nx0, nx1, n0, n1;

    ix0 = FASTFLOOR( x );
    iy0 = FASTFLOOR( y );
    iz0 = FASTFLOOR( z );
    iw0 = FASTFLOOR( w );
    fx0 = x - ix0;
    fy0 = y - iy0;
    fz0 = z - iz0;
    fw0 = w - iw0;
    fx1 = fx0 - 1.0f;
    fy1 = fy0 - 1.0f;
    fz1 = fz0 - 1.0f;
    fw1 = fw0 - 1.0f;
    ix1 = (( ix0 + 1 ) % px ) & 0xff;
    iy1 = (( iy0 + 1 ) % py ) & 0xff;
    iz1 = (( iz0 + 1 ) % pz ) & 0xff;
    iw1 = (( iw0 + 1 ) % pw ) & 0xff;
    ix0 = ( ix0 % px ) & 0xff;
    iy0 = ( iy0 % py ) & 0xff;
    iz0 = ( iz0 % pz ) & 0xff;
    iw0 = ( iw0 % pw ) & 0xff;

    q = FADE( fw0 );
    r = FADE( fz0 );
    t = FADE( fy0 );
    s = FADE( fx0 );

    nxyz0 = grad(perm[ix0 + perm[iy0 + perm[iz0 + perm[iw0]]]], fx0, fy0, fz0, fw0);
    nxyz1 = grad(perm[ix0 + perm[iy0 + perm[iz0 + perm[iw1]]]], fx0, fy0, fz0, fw1);
    nxy0 = LERP( q, nxyz0, nxyz1 );
        
    nxyz0 = grad(perm[ix0 + perm[iy0 + perm[iz1 + perm[iw0]]]], fx0, fy0, fz1, fw0);
    nxyz1 = grad(perm[ix0 + perm[iy0 + perm[iz1 + perm[iw1]]]], fx0, fy0, fz1, fw1);
    nxy1 = LERP( q, nxyz0, nxyz1 );
        
    nx0 = LERP ( r, nxy0, nxy1 );

    nxyz0 = grad(perm[ix0 + perm[iy1 + perm[iz0 + perm[iw0]]]], fx0, fy1, fz0, fw0);
    nxyz1 = grad(perm[ix0 + perm[iy1 + perm[iz0 + perm[iw1]]]], fx0, fy1, fz0, fw1);
    nxy0 = LERP( q, nxyz0, nxyz1 );
        
    nxyz0 = grad(perm[ix0 + perm[iy1 + perm[iz1 + perm[iw0]]]], fx0, fy1, fz1, fw0);
    nxyz1 = grad(perm[ix0 + perm[iy1 + perm[iz1 + perm[iw1]]]], fx0, fy1, fz1, fw1);
    nxy1 = LERP( q, nxyz0, nxyz1 );

    nx1 = LERP ( r, nxy0, nxy1 );

    n0 = LERP( t, nx0, nx1 );

    nxyz0 = grad(perm[ix1 + perm[iy0 + perm[iz0 + perm[iw0]]]], fx1, fy0, fz0, fw0);
    nxyz1 = grad(perm[ix1 + perm[iy0 + perm[iz0 + perm[iw1]]]], fx1, fy0, fz0, fw1);
    nxy0 = LERP( q, nxyz0, nxyz1 );
        
    nxyz0 = grad(perm[ix1 + perm[iy0 + perm[iz1 + perm[iw0]]]], fx1, fy0, fz1, fw0);
    nxyz1 = grad(perm[ix1 + perm[iy0 + perm[iz1 + perm[iw1]]]], fx1, fy0, fz1, fw1);
    nxy1 = LERP( q, nxyz0, nxyz1 );

    nx0 = LERP ( r, nxy0, nxy1 );

    nxyz0 = grad(perm[ix1 + perm[iy1 + perm[iz0 + perm[iw0]]]], fx1, fy1, fz0, fw0);
    nxyz1 = grad(perm[ix1 + perm[iy1 + perm[iz0 + perm[iw1]]]], fx1, fy1, fz0, fw1);
    nxy0 = LERP( q, nxyz0, nxyz1 );
        
    nxyz0 = grad(perm[ix1 + perm[iy1 + perm[iz1 + perm[iw0]]]], fx1, fy1, fz1, fw0);
    nxyz1 = grad(perm[ix1 + perm[iy1 + perm[iz1 + perm[iw1]]]], fx1, fy1, fz1, fw1);
    nxy1 = LERP( q, nxyz0, nxyz1 );

    nx1 = LERP ( r, nxy0, nxy1 );

    n1 = LERP( t, nx0, nx1 );

    return 0.5f * (1.0f + 0.87f * ( LERP( s, n0, n1 ) ) );
}
















///////////////////////////////////////////////////////////////////////
// Function				:	noiseFloat1D
// Description			:
// Return Value			:
// Comments				:
float noiseFloat(float arg) {
	return	noise<float>(arg,permX);
}

///////////////////////////////////////////////////////////////////////
// Function				:	noiseFloat2D
// Description			:
// Return Value			:
// Comments				:
float noiseFloat(float uarg,float varg) {
	return	noise<float>(uarg,varg,permX);
}

///////////////////////////////////////////////////////////////////////
// Function				:	noiseFloat3D
// Description			:
// Return Value			:
// Comments				:
float noiseFloat(const float *vec) {
	return	noise<float>(vec[0],vec[1],vec[2],permX);
}

///////////////////////////////////////////////////////////////////////
// Function				:	noiseFloat4D
// Description			:
// Return Value			:
// Comments				:
float	noiseFloat(const float *argu,float argv) {
	return	noise<float>(argu[0],argu[1],argu[2],argv,permX);
}

///////////////////////////////////////////////////////////////////////
// Function				:	noiseVector1D
// Description			:
// Return Value			:
// Comments				:
void noiseVector(float *r,float arg) {
	r[0]	=	noise<float>(arg,permX);
	r[1]	=	noise<float>(arg,permY);
	r[2]	=	noise<float>(arg,permZ);
}

///////////////////////////////////////////////////////////////////////
// Function				:	noiseVector2D
// Description			:
// Return Value			:
// Comments				:
void noiseVector(float *r,float uarg,float varg) {
	r[0]	=	noise<float>(uarg,varg,permX);
	r[1]	=	noise<float>(uarg,varg,permY);
	r[2]	=	noise<float>(uarg,varg,permZ);
}

///////////////////////////////////////////////////////////////////////
// Function				:	noiseVector3D
// Description			:
// Return Value			:
// Comments				:
void noiseVector(float *r,const float *vec) {
	r[0]	=	noise<float>(vec[0],vec[1],vec[2],permX);
	r[1]	=	noise<float>(vec[0],vec[1],vec[2],permY);
	r[2]	=	noise<float>(vec[0],vec[1],vec[2],permZ);
}


///////////////////////////////////////////////////////////////////////
// Function				:	noiseVector4D
// Description			:
// Return Value			:
// Comments				:
void	noiseVector(float *r,const float *argu,float argv) {
	r[0]	=		noise<float>(argu[0],argu[1],argu[2],argv,permX);
	r[1]	=		noise<float>(argu[0],argu[1],argu[2],argv,permY);
	r[2]	=		noise<float>(argu[0],argu[1],argu[2],argv,permZ);
}



///////////////////////////////////////////////////////////////////////
// Function				:	pnoiseFloat1D
// Description			:
// Return Value			:
// Comments				:
float	pnoiseFloat(float u,float uperiod) {
	return pnoise<float>(u,(int) uperiod,permX);
}


///////////////////////////////////////////////////////////////////////
// Function				:	pnoiseFloat2D
// Description			:
// Return Value			:
// Comments				:
float	pnoiseFloat(float u,float v,float uperiod,float vperiod) {
	return pnoise<float>(u,v,(int) uperiod,(int) vperiod,permX);
}

///////////////////////////////////////////////////////////////////////
// Function				:	pnoiseFloat3D
// Description			:
// Return Value			:
// Comments				:
float	pnoiseFloat(const float *arg,const float *periods) {
	return pnoise<float>(arg[0],arg[1],arg[2],(int) periods[0],(int) periods[1],(int) periods[2],permX);
}

///////////////////////////////////////////////////////////////////////
// Function				:	pnoiseFloat4D
// Description			:
// Return Value			:
// Comments				:
float	pnoiseFloat(const float *arg,float w,const float *periods,float wperiod) {
	return pnoise<float>(arg[0],arg[1],arg[2],w,(int) periods[0],(int) periods[1],(int) periods[2],(int) wperiod,permX);
}

///////////////////////////////////////////////////////////////////////
// Function				:	pnoiseVector1D
// Description			:
// Return Value			:
// Comments				:
void	pnoiseVector(float *r,float u,float uperiod) {
	r[0]	=	pnoise<float>(u,(int) uperiod,permX);
	r[1]	=	pnoise<float>(u,(int) uperiod,permY);
	r[2]	=	pnoise<float>(u,(int) uperiod,permZ);
}

///////////////////////////////////////////////////////////////////////
// Function				:	pnoiseVector2D
// Description			:
// Return Value			:
// Comments				:
void	pnoiseVector(float *r,float u,float v,float uperiod,float vperiod) {
	r[0]	=	pnoise<float>(u,v,(int) uperiod,(int) vperiod,permX);
	r[1]	=	pnoise<float>(u,v,(int) uperiod,(int) vperiod,permY);
	r[2]	=	pnoise<float>(u,v,(int) uperiod,(int) vperiod,permZ);
}

///////////////////////////////////////////////////////////////////////
// Function				:	pnoiseVector3D
// Description			:
// Return Value			:
// Comments				:
void	pnoiseVector(float *r,const float *arg,const float *periods) {
	r[0]	=	pnoise<float>(arg[0],arg[1],arg[2],(int) periods[0],(int) periods[1],(int) periods[2],permX);
	r[1]	=	pnoise<float>(arg[0],arg[1],arg[2],(int) periods[0],(int) periods[1],(int) periods[2],permY);
	r[2]	=	pnoise<float>(arg[0],arg[1],arg[2],(int) periods[0],(int) periods[1],(int) periods[2],permZ);
}

///////////////////////////////////////////////////////////////////////
// Function				:	pnoiseVector4D
// Description			:
// Return Value			:
// Comments				:
void	pnoiseVector(float *r,const float *arg,float w,const float *periods,float wperiod) {
	r[0]	=	pnoise<float>(arg[0],arg[1],arg[2],w,(int) periods[0],(int) periods[1],(int) periods[2],(int) wperiod,permX);
	r[1]	=	pnoise<float>(arg[0],arg[1],arg[2],w,(int) periods[0],(int) periods[1],(int) periods[2],(int) wperiod,permY);
	r[2]	=	pnoise<float>(arg[0],arg[1],arg[2],w,(int) periods[0],(int) periods[1],(int) periods[2],(int) wperiod,permZ);
}

// Musc macro to permute the inputs
#define	permute(__val)																\
	if (__val < 0)	i = permN[	(i + ((unsigned int) (__val - 1))) & 4095	];		\
	else			i = permN[	(i + ((unsigned int) __val)) & 4095	];

///////////////////////////////////////////////////////////////////////
// Function				:	cellNoiseFloat1D
// Description			:	Fast cell noise implementation
// Return Value			:
// Comments				:
float	cellNoiseFloat(float arg) {
	unsigned int	i	=	0;

	permute(arg);

	return	randN[i];
}

///////////////////////////////////////////////////////////////////////
// Function				:	cellNoiseFloat2D
// Description			:
// Return Value			:
// Comments				:
float	cellNoiseFloat(float u,float v) {
	unsigned int	i	=	0;

	permute(u);
	permute(v);

	return	randN[i];
}

///////////////////////////////////////////////////////////////////////
// Function				:	cellNoiseFloat3D
// Description			:
// Return Value			:
// Comments				:
float	cellNoiseFloat(const float *arg) {
	unsigned int	i	=	0;

	permute(arg[0]);
	permute(arg[1]);
	permute(arg[2]);

	return	randN[i];
}

///////////////////////////////////////////////////////////////////////
// Function				:	cellNoiseFloat4D
// Description			:
// Return Value			:
// Comments				:
float	cellNoiseFloat(const float *arg,float w) {
	unsigned int	i	=	0;

	permute(arg[0]);
	permute(arg[1]);
	permute(arg[2]);
	permute(w);

	return	randN[i];
}

///////////////////////////////////////////////////////////////////////
// Function				:	cellNoiseVector1D
// Description			:
// Return Value			:
// Comments				:
void	cellNoiseVector(float *r,float arg) {
	unsigned int	i	=	0;

	permute(arg);

	r[0]	=	randN[i];
	r[1]	=	randN[permN[i]];
	r[2]	=	randN[permN[permN[i]]];
}

///////////////////////////////////////////////////////////////////////
// Function				:	cellNoiseVector2D
// Description			:
// Return Value			:
// Comments				:
void	cellNoiseVector(float *r,float u,float v) {
	unsigned int	i	=	0;

	permute(u);
	permute(v);

	r[0]	=	randN[i];
	r[1]	=	randN[permN[i]];
	r[2]	=	randN[permN[permN[i]]];
}

///////////////////////////////////////////////////////////////////////
// Function				:	cellNoiseVector3D
// Description			:
// Return Value			:
// Comments				:
void	cellNoiseVector(float *r,const float *arg) {
	unsigned int	i	=	0;

	permute(arg[0]);
	permute(arg[1]);
	permute(arg[2]);

	r[0]	=	randN[i];
	r[1]	=	randN[permN[i]];
	r[2]	=	randN[permN[permN[i]]];
}

///////////////////////////////////////////////////////////////////////
// Function				:	cellNoiseVector4D
// Description			:
// Return Value			:
// Comments				:
void	cellNoiseVector(float *r,const float *arg,float w) {
	unsigned int	i	=	0;

	permute(arg[0]);
	permute(arg[1]);
	permute(arg[2]);
	permute(w);

	r[0]	=	randN[i];
	r[1]	=	randN[permN[i]];
	r[2]	=	randN[permN[permN[i]]];
}